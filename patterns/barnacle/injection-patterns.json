{
  "version": "2.0.0",
  "description": "BarnacleDefense injection pattern database — comprehensive prompt injection, code injection, shell injection, template injection, SQL injection, deserialization, and SSRF/XXE detection. All regexes are valid Rust regex crate syntax (no lookahead/lookbehind).",
  "coverage_notes": {
    "last_audit": "2026-02-18",
    "regex_engine": "rust regex crate >=1.10 (no lookaround assertions)",
    "categories": "prompt_injection (25), code_injection (45), shell_injection (25), template_injection (25), sql_injection (20), deserialization (15), ssrf_xxe (10)",
    "false_positive_strategy": "Patterns target specific dangerous function calls and constructs rather than general keywords. (?i) case-insensitive used throughout. Word boundaries \\b used to prevent substring matches.",
    "categories_added_in_v2": ["sql_injection", "deserialization", "ssrf_xxe"],
    "breaking_changes_from_v1": "None — all v1 patterns preserved and expanded."
  },
  "patterns": {
    "prompt_injection": [
      "(?i)ignore\\s+(all\\s+)?(previous|prior|above|earlier|preceding)\\s+(instructions|rules|guidelines|prompts|context|directives)",
      "(?i)disregard\\s+(all\\s+)?(previous|prior|above|your)\\s+(instructions|rules|guidelines|programming|directives)",
      "(?i)forget\\s+(all\\s+)?(previous|prior|above|your|earlier)\\s+(instructions|rules|context|guidelines)",
      "(?i)you\\s+are\\s+now\\s+(a|an|in)\\s+(unrestricted|jailbreak|DAN|evil|unfiltered)",
      "(?i)new\\s+(system\\s+)?prompt",
      "(?i)override\\s+(system|safety|security|your)\\s+(prompt|instructions|rules|guidelines|programming)",
      "(?i)pretend\\s+you\\s+(are|have)\\s+no\\s+(restrictions|rules|guidelines|filters|limits|constraints)",
      "(?i)act\\s+as\\s+(if|though)\\s+you\\s+(have|had)\\s+no\\s+(filters|restrictions|rules|guidelines|constraints)",
      "(?i)\\bDAN\\s+mode\\b",
      "(?i)(developer|debug|maintenance|admin|god|test)\\s+mode\\s+(enabled|activated|on|engaged)",
      "(?i)bypass\\s+(content|safety|security|ethical)\\s+(filter|policy|check|system|guard|rail)",
      "(?i)(from\\s+now\\s+on|henceforth|going\\s+forward)\\s+you\\s+(are|will|must|should|shall)",
      "(?i)<\\|?(system|im_start|im_end|endoftext|assistant|user|human|end_turn)\\|?>",
      "(?i)\\[INST\\]|\\[/INST\\]|\\[SYS\\]|\\[/SYS\\]",
      "(?i)```(system|instructions|rules|prompt|config)\\b",
      "(?i)\"role\"\\s*:\\s*\"(system|assistant|function)\"",
      "(?i)<(system|assistant)[_-]?(prompt|message|instruction|context|response)",
      "(?i)pretend\\s+(the|this|that).{0,30}(is\\s+your|system|new)\\s+(prompt|instruction|rule)",
      "(?i)(end\\s+of|stop|reset)\\s+(session|conversation|context|chat).{0,30}(new|begin|start|fresh)",
      "(?i)(the\\s+)?assistant('s)?\\s+(response|reply|answer|output)\\s+(is|should\\s+be|will\\s+be)\\s*:",
      "(?i)\\b(Human|User|Assistant|AI|System)\\s*:",
      "(?i)(your\\s+)?(real|actual|true|hidden|secret)\\s+(instructions|prompt|rules|programming)\\s+(are|say|tell)",
      "(?i)(remember|store|save)\\s+this\\s+(instruction|rule|command).{0,30}(for\\s+later|always|permanently)",
      "(?i)(decode|deobfuscate|decrypt|unrot13)\\s+this.{0,30}(instruction|command|payload|message)",
      "(?i)(when|after|once)\\s+asked\\s+about.{0,30}(always|must|should)\\s+(respond|reply|answer|say)"
    ],
    "code_injection": [
      "(?i)\\beval\\s*\\(",
      "(?i)\\bexec\\s*\\(",
      "(?i)\\b__import__\\s*\\(",
      "(?i)\\bimportlib\\.import_module\\s*\\(",
      "(?i)\\bcompile\\s*\\(.*\\bexec\\b",
      "(?i)\\bgetattr\\s*\\(.*\\bos\\b",
      "(?i)\\bsetattr\\s*\\(.*\\bos\\b",
      "(?i)subprocess\\.(?:call|run|Popen|check_output|check_call|getoutput|getstatusoutput)\\s*\\(",
      "(?i)os\\.(?:system|popen|popen[234]?|exec[lv]?[pe]?|spawn[lv]?[pe]?)\\s*\\(",
      "(?i)os\\.(?:startfile|execvpe)\\s*\\(",
      "(?i)\\bcommands\\.(?:getoutput|getstatusoutput)\\s*\\(",
      "(?i)\\bpty\\.spawn\\s*\\(",
      "(?i)\\bctypes\\.(?:CDLL|cdll|windll|WinDLL)\\s*\\(",
      "(?i)\\bmarshal\\.loads\\s*\\(",
      "(?i)\\bshelve\\.open\\s*\\(",
      "(?i)\\bcode\\.(?:compile_command|interact)\\s*\\(",
      "(?i)\\bcodeop\\.(?:compile_command|CommandCompiler)\\s*\\(",
      "(?i)\\brunpy\\.(?:run_module|run_path)\\s*\\(",
      "(?i)\\bmultiprocessing\\.Process\\s*\\(",
      "(?i)yaml\\.(?:load|unsafe_load|full_load)\\s*\\(",
      "(?i)\\bpickle\\.(?:loads?|Unpickler)\\s*\\(",
      "(?i)\\bcPickle\\.(?:loads?|Unpickler)\\s*\\(",
      "(?i)\\bjsonpickle\\.(?:decode|loads)\\s*\\(",
      "(?i)\\b(?:child_process|spawn|execFile|execSync|spawnSync|execFileSync)\\s*\\(",
      "(?i)\\brequire\\s*\\(\\s*['\"]child_process['\"]\\s*\\)",
      "(?i)new\\s+Function\\s*\\(",
      "(?i)\\bvm\\.(?:runInContext|runInNewContext|runInThisContext|createContext|Script)\\s*\\(",
      "(?i)\\bvm2\\.(?:VM|NodeVM)\\s*\\(",
      "(?i)\\bWebAssembly\\.(?:instantiate|compile|Module)\\s*\\(",
      "(?i)\\bWorker\\s*\\(.*(?:blob|data:)\\b",
      "(?i)\\bsystem\\s*\\(",
      "(?i)\\bpassthru\\s*\\(",
      "(?i)\\bshell_exec\\s*\\(",
      "(?i)\\bproc_open\\s*\\(",
      "(?i)\\bpopen\\s*\\(",
      "(?i)\\bassert\\s*\\(.*\\$",
      "(?i)\\bpcntl_exec\\s*\\(",
      "(?i)Runtime\\.getRuntime\\(\\)\\.exec\\s*\\(",
      "(?i)ProcessBuilder\\s*\\(",
      "(?i)\\bScriptEngine\\b.*\\beval\\s*\\(",
      "(?i)javax\\.naming\\.InitialContext\\s*\\(",
      "(?i)\\bjndi:.*://",
      "(?i)std::process::Command\\s*::\\s*new\\s*\\(",
      "(?i)os/exec\\.Command\\s*\\(",
      "(?i)\\bKernel\\.(exec|system|spawn)\\s*\\(",
      "(?i)\\bIO\\.popen\\s*\\("
    ],
    "shell_injection": [
      "(?i);\\s*(cat|curl|wget|nc|ncat|bash|sh|dash|zsh|python[23]?|perl|ruby|php|lua|node|tclsh)\\b",
      "(?i)\\|\\s*(bash|sh|dash|zsh|python[23]?|perl|ruby|php|lua|node|tclsh)\\b",
      "(?i)\\$\\(.*\\b(curl|wget|nc|ncat|bash|sh|python|perl|ruby)\\b",
      "(?i)`.*\\b(curl|wget|nc|ncat|bash|sh|python|perl|ruby)\\b.*`",
      "(?i)\\b(curl|wget)\\b.*\\|\\s*(bash|sh|dash|zsh|python|perl|ruby)\\b",
      "(?i)&&\\s*(cat|curl|wget|nc|ncat|bash|sh|python|perl|ruby|id|whoami|uname)\\b",
      "(?i)\\|\\|\\s*(cat|curl|wget|nc|ncat|bash|sh|python|perl|ruby|id|whoami)\\b",
      "(?i)\\bIFS\\s*=",
      "(?i)\\\\n\\s*(cat|curl|wget|nc|bash|sh|python|perl|id|whoami|uname)\\b",
      "(?i)\\\\x[0-9a-fA-F]{2}.*\\\\x[0-9a-fA-F]{2}.*\\\\x[0-9a-fA-F]{2}",
      "(?i)\\\\[0-7]{3}.*\\\\[0-7]{3}.*\\\\[0-7]{3}",
      "(?i)\\$\\{IFS\\}",
      "(?i)\\$\\{.*:-.*\\}.*\\$\\{.*:-.*\\}",
      "(?i)/dev/tcp/[0-9a-zA-Z]",
      "(?i)/dev/udp/[0-9a-zA-Z]",
      "(?i)>\\s*&\\s*/dev/tcp/",
      "(?i)exec\\s+\\d+<>/dev/tcp/",
      "(?i)\\becho\\b.*\\|\\s*\\bbase64\\s+-d\\b.*\\|\\s*(bash|sh)\\b",
      "(?i)\\bprintf\\b.*\\\\x[0-9a-fA-F].*\\|\\s*(bash|sh)\\b",
      "(?i)\\bxxd\\s+-r\\b.*\\|\\s*(bash|sh)\\b",
      "(?i)<<\\s*['\"]?EOF\\b.*\\b(bash|sh|python|perl|ruby)\\b",
      "(?i)<\\s*\\(.*\\b(curl|wget|nc)\\b",
      "(?i)>\\(.*\\b(curl|wget|nc)\\b",
      "(?i)\\*\\s*/\\s*\\*.*\\b(cat|curl|wget|nc|bash|sh)\\b",
      "(?i)\\$\\{!.*\\}.*\\$\\{!.*\\}"
    ],
    "template_injection": [
      "(?i)\\{\\{.*(?:config|self|request|lipsum|cycler|joiner|namespace|range).*\\}\\}",
      "(?i)\\{\\{.*__class__.*\\}\\}",
      "(?i)\\{\\{.*__subclasses__.*\\}\\}",
      "(?i)\\{\\{.*__builtins__.*\\}\\}",
      "(?i)\\{\\{.*__globals__.*\\}\\}",
      "(?i)\\{\\{.*__init__.*__globals__.*\\}\\}",
      "(?i)\\{\\{.*\\b(popen|system|exec|import)\\b.*\\}\\}",
      "(?i)\\{\\{.*\\.mro\\(\\).*\\}\\}",
      "(?i)\\{%.*(?:import|include|extends|from|block).*%\\}",
      "(?i)\\{%.*(?:set|call|macro|filter).*(?:os|subprocess|import).*%\\}",
      "(?i)\\$\\{.*(?:Runtime|ProcessBuilder|exec|getRuntime).*\\}",
      "(?i)\\$\\{.*\\bclass\\.forName\\b.*\\}",
      "(?i)\\$\\{T\\(.*\\)\\}",
      "(?i)#\\{.*Runtime.*exec.*\\}",
      "(?i)#\\{.*ProcessBuilder.*\\}",
      "(?i)\\$\\{.*\\.getClass\\(\\).*\\}",
      "(?i)\\$\\{.*java\\.lang.*\\}",
      "(?i)<%.*(?:Runtime|Process|exec|system|popen).*%>",
      "(?i)<%=.*(?:system|exec|popen|spawn).*%>",
      "(?i)\\b__ognl.*exec\\b",
      "(?i)%\\{.*(?:Runtime|ProcessBuilder|exec).*\\}",
      "(?i)\\$\\{.*(?:freemarker|exec|new|ObjectConstructor).*\\}",
      "(?i)\\bvelocity\\b.*#set.*exec",
      "(?i)\\$class\\.inspect.*exec",
      "(?i)\\bthymeleaf\\b.*\\$\\{.*exec.*\\}"
    ],
    "sql_injection": [
      "(?i)\\bUNION\\s+(ALL\\s+)?SELECT\\b",
      "(?i)\\bOR\\s+['\"]?1['\"]?\\s*=\\s*['\"]?1",
      "(?i)\\bOR\\s+['\"]?[a-z]['\"]?\\s*=\\s*['\"]?[a-z]",
      "(?i)\\bAND\\s+['\"]?1['\"]?\\s*=\\s*['\"]?0",
      "(?i)';\\s*--",
      "(?i)\";\\s*--",
      "(?i)\\bDROP\\s+(TABLE|DATABASE|INDEX|VIEW|PROCEDURE)\\b",
      "(?i)\\bDELETE\\s+FROM\\b.*\\bWHERE\\s+1\\s*=\\s*1",
      "(?i)\\bINSERT\\s+INTO\\b.*\\bVALUES\\b.*\\(\\s*['\"].*['\"]\\s*\\)",
      "(?i)\\bUPDATE\\b.*\\bSET\\b.*\\bWHERE\\s+1\\s*=\\s*1",
      "(?i)\\b(SLEEP|BENCHMARK|WAITFOR|pg_sleep|DBMS_LOCK\\.SLEEP)\\s*\\(",
      "(?i)\\bLOAD_FILE\\s*\\(",
      "(?i)\\bINTO\\s+(OUT|DUMP)FILE\\b",
      "(?i)\\bINFORMATION_SCHEMA\\b",
      "(?i)\\bsys\\.(?:tables|columns|databases|objects)\\b",
      "(?i)\\b(CHAR|CHR|CONCAT|SUBSTRING|ASCII|HEX|UNHEX)\\s*\\(.*\\b(SELECT|UNION|FROM|WHERE)\\b",
      "(?i)\\$(?:gt|gte|lt|lte|ne|in|nin|regex|where|exists|type)\\s*:",
      "(?i)\\$where\\s*:\\s*['\"].*function",
      "(?i)\\{\\s*\\$(?:gt|ne|regex)\\s*:",
      "(?i)\\bdb\\.[a-zA-Z]+\\.find\\s*\\(.*\\$(?:gt|ne|where)"
    ],
    "deserialization": [
      "(?i)\\bpickle\\.loads\\b",
      "(?i)\\bcPickle\\.loads\\b",
      "(?i)\\bshelve\\.open\\b",
      "(?i)\\bjsonpickle\\.decode\\b",
      "(?i)\\byaml\\.(?:load|unsafe_load|full_load)\\b",
      "(?i)\\bObjectInputStream\\b",
      "(?i)\\breadObject\\s*\\(",
      "(?i)\\bXMLDecoder\\b",
      "(?i)\\bBinaryFormatter\\b.*\\bDeserialize\\b",
      "(?i)\\bNewtonsoft\\.Json.*TypeNameHandling",
      "(?i)\\bSystem\\.Runtime\\.Serialization\\b",
      "(?i)\\bunserialize\\s*\\(",
      "(?i)\\bphp://input\\b",
      "(?i)\\bMarshal\\.load\\b",
      "(?i)rO0AB[A-Za-z0-9+/=]{10,}"
    ],
    "ssrf_xxe": [
      "(?i)\\b169\\.254\\.169\\.254\\b",
      "(?i)\\bmetadata\\.google\\.internal\\b",
      "(?i)/latest/meta-data/",
      "(?i)/latest/user-data/",
      "(?i)\\b100\\.100\\.100\\.200\\b",
      "(?i)\\b169\\.254\\.170\\.2\\b",
      "(?i)<!DOCTYPE\\s+.*\\[.*<!ENTITY",
      "(?i)<!ENTITY\\s+.*SYSTEM\\s+['\"]",
      "(?i)file:///etc/(passwd|shadow|hosts)",
      "(?i)\\bexpect://\\b"
    ]
  }
}
