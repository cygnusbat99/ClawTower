{
  "version": "2.0.0",
  "description": "BarnacleDefense dangerous command pattern database â€” categorized by threat type. Exhaustive coverage across 11 threat categories with 200+ patterns. All regexes are valid Rust `regex` crate syntax (no lookaheads/lookbehinds).",
  "coverage_notes": {
    "last_audit": "2026-02-18",
    "regex_engine": "rust regex crate >=1.10 (no lookaround assertions)",
    "false_positive_strategy": "Patterns target specific dangerous flag combinations rather than bare command names. Allowlist filtering in barnacle.rs handles sudo false positives. Case-insensitive (?i) used throughout.",
    "categories_added_in_v2": ["cryptomining", "credential_harvesting", "lateral_movement"],
    "breaking_changes_from_v1": "Removed (?!...) negative lookahead patterns (unsupported by Rust regex crate). Replaced rm/truncate patterns with explicit path-matching alternatives."
  },
  "categories": {
    "destructive": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "\\brm\\s+(-[a-zA-Z]*f[a-zA-Z]*\\s+)?/(bin|boot|dev|etc|home|lib|opt|root|run|sbin|srv|sys|usr|var)",
        "\\brm\\s+(-[a-zA-Z]*r[a-zA-Z]*\\s+)(-[a-zA-Z]*f[a-zA-Z]*\\s+)?/\\s",
        "\\brm\\s+(-[a-zA-Z]*f[a-zA-Z]*\\s+)?(-[a-zA-Z]*r[a-zA-Z]*\\s+)?/\\s",
        "\\brm\\s+-[a-zA-Z]*r[a-zA-Z]*f[a-zA-Z]*\\s+/",
        "\\brm\\s+-[a-zA-Z]*f[a-zA-Z]*r[a-zA-Z]*\\s+/",
        "\\bdd\\s+.*\\bof=/dev/[a-z]",
        "\\bdd\\s+.*\\bof=/(boot|etc|home|root|var)",
        "\\bmkfs\\b",
        "\\bmkfs\\.[a-z0-9]+\\b",
        "\\bshred\\b.*(/dev/|/etc/|/var/|/home/|/boot/|/root/)",
        "\\bshred\\b.*-[a-zA-Z]*z",
        "(?i)\\bwipefs\\b.*(-a|--all|/dev/)",
        "(?i)\\bsgdisk\\b.*(-Z|--zap-all|--clear)",
        "(?i)\\bparted\\b.*(mklabel|rm|mkpart)\\b",
        "(?i)\\bgdisk\\b.*(-z|--zap)",
        "(?i)\\bfdisk\\b.*/dev/[a-z]",
        "(?i)\\blvremove\\b",
        "(?i)\\bvgremove\\b",
        "(?i)\\bpvremove\\b",
        "(?i)\\blvcreate\\b.*--zero",
        "(?i)\\bmdadm\\b.*--(stop|zero-superblock|kill-subarray)",
        "(?i)\\bmdadm\\b.*-S\\b",
        "(?i)\\bdebugfs\\b.*-w\\b",
        "(?i)\\btune2fs\\b.*-O\\b",
        "(?i)\\bswapoff\\b.*-a",
        "(?i)\\bmkswap\\b.*/dev/",
        "(?i)\\bdd\\b.*if=/dev/(zero|urandom|random).*of=/(boot|etc|home|var|root)",
        "(?i)\\bdd\\b.*of=/dev/sda",
        "\\b:>\\s*/(etc|var|home|root|boot|usr)/",
        "\\btruncate\\s+.*/(etc|var|home|root|boot|usr)/",
        "(?i)\\bfallocate\\b.*/(etc|var|home|root|boot)/",
        "(?i)\\bfind\\s+/\\s+.*-delete\\b",
        "(?i)\\bfind\\s+/(etc|var|home|root|boot|usr)\\s+.*-delete\\b",
        "(?i)\\bxargs\\s+rm\\b.*/",
        "(?i)\\bmv\\s+/dev/(null|zero)\\s+/(etc|var|home|root|boot)/",
        "(?i)\\bcp\\s+/dev/(null|zero)\\s+/(etc|var|home|root|boot)/",
        "(?i)\\brmmod\\b\\s+(ext4|xfs|btrfs|nfs|iptable|ip_tables|nf_conntrack|dm_mod|scsi_mod|ahci|nvme|virtio)",
        "(?i)\\bip\\s+link\\s+(delete|set.*down)\\s+(eth|ens|eno|enp|wlan|wlp|br|bond|virbr)",
        "(?i)\\bifconfig\\s+(eth|ens|eno|enp|wlan|wlp)\\S*\\s+down\\b",
        ":\\(\\)\\{\\s*:\\|:\\&\\s*\\}\\s*;\\s*:",
        "(?i)\\bforkbomb\\b",
        "(?i)\\.\\/(fork|bomb)",
        "(?i)\\byes\\b\\s*>\\s*/(dev/|etc/|var/)",
        "(?i)cat\\s+/dev/(zero|urandom)\\s*>\\s*/(etc|var|home|root|boot)/",
        "(?i)\\bkillall\\s+-9\\s+(init|systemd)\\b",
        "(?i)\\bkill\\s+-9\\s+1\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.panic=",
        "(?i)echo\\s+[co]\\s*>\\s*/proc/sysrq-trigger"
      ]
    },
    "data_exfiltration": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\b(curl|wget|nc|ncat)\\b.*(-d|--data|-X\\s*POST).*(@/etc/|@/home/|@/root/)",
        "(?i)\\bscp\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|id_rsa|id_ed25519|id_ecdsa)",
        "(?i)\\btar\\b.*\\b(czf|cjf|cf)\\b.*\\|\\s*(curl|nc|ncat|base64)",
        "(?i)\\bbase64\\b.*\\|\\s*(curl|wget|nc|ncat|socat)",
        "(?i)\\bcat\\s+(/etc/shadow|.*id_rsa|.*id_ed25519|.*\\.pem|.*\\.key)\\s*\\|",
        "(?i)\\b(dig|nslookup|host)\\b.*\\$\\(",
        "(?i)\\bdig\\b.*TXT\\b.*\\$",
        "(?i)\\b(dig|nslookup|host)\\b.*\\`",
        "(?i)\\bping\\b.*-p\\s+[0-9a-fA-F]{16,}",
        "(?i)\\brsync\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|id_rsa|id_ed25519|\\.gnupg/|\\.aws/).*@",
        "(?i)\\brsync\\b.*@.*:.*(/etc/|/home/|/root/|/var/)",
        "(?i)\\b(ftp|sftp|ftps)\\b.*put\\b.*(/etc/|/home/|/root/)",
        "(?i)\\b(ftp|sftp)\\b.*mput\\b",
        "(?i)\\bgit\\s+(push|remote\\s+add)\\b.*(/etc/shadow|/etc/passwd|id_rsa|\\.env|\\.aws)",
        "(?i)\\bgit\\s+push\\b.*--force\\b",
        "(?i)\\bdocker\\s+cp\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|id_rsa)",
        "(?i)\\bkubectl\\s+cp\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|id_rsa)",
        "(?i)\\bsocat\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|id_rsa|\\.pem)",
        "(?i)\\bsocat\\b.*EXEC.*TCP",
        "(?i)\\bopenssl\\s+s_client\\b.*<\\s*/etc/",
        "(?i)\\bopenssl\\s+s_client\\b.*-connect.*<",
        "(?i)\\bpython[23]?\\b.*http\\.server\\b",
        "(?i)\\bpython[23]?\\b.*SimpleHTTPServer\\b",
        "(?i)\\bpython[23]?\\b.*HTTPServer\\b",
        "(?i)\\bruby\\b.*-r\\s*webrick\\b",
        "(?i)\\bperl\\b.*HTTP::Server",
        "(?i)\\bphp\\s+-S\\b",
        "(?i)\\bxxd\\b.*\\|\\s*(curl|wget|nc|ncat|socat)",
        "(?i)\\bod\\b.*\\|\\s*(curl|wget|nc|ncat|socat)",
        "(?i)/dev/tcp/[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+",
        "(?i)/dev/udp/[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+",
        "(?i)\\b(sendmail|mail|mutt|msmtp|ssmtp)\\b.*-[aA].*(/etc/|/home/|/root/|\\.ssh/)",
        "(?i)\\b(sendmail|mail|mutt)\\b.*<\\s*(/etc/shadow|.*id_rsa|.*\\.pem)",
        "(?i)\\baws\\s+s3\\s+(cp|sync|mv)\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|\\.aws/|\\.gnupg/|id_rsa)",
        "(?i)\\bgsutil\\s+(cp|rsync|mv)\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|\\.aws/|id_rsa)",
        "(?i)\\baz\\s+storage\\s+blob\\s+upload\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|\\.aws/|id_rsa)",
        "(?i)\\bgcloud\\s+storage\\s+cp\\b.*(/etc/shadow|/etc/passwd|\\.ssh/|\\.aws/|id_rsa)",
        "(?i)\\bsteghide\\b.*embed\\b",
        "(?i)\\bstegano\\b",
        "(?i)\\bopenstego\\b",
        "(?i)\\bexiftool\\b.*-Comment=",
        "(?i)\\bcurl\\b.*--upload-file\\b.*(/etc/|/home/|/root/|\\.ssh/)",
        "(?i)\\bwget\\b.*--post-file\\b.*(/etc/|/home/|/root/|\\.ssh/)",
        "(?i)\\bnc\\b.*<\\s*(/etc/shadow|/etc/passwd|.*id_rsa|.*\\.pem|.*\\.key)",
        "(?i)\\b(gzip|bzip2|xz|zstd)\\b.*\\|\\s*(curl|wget|nc|ncat|socat|openssl)",
        "(?i)\\btar\\b.*\\|\\s*(openssl|socat|ssh)\\b"
      ]
    },
    "reverse_shell": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\bnc\\b.*-[a-z]*e\\s*/bin/(ba)?sh",
        "(?i)\\bncat\\b.*-[a-z]*e\\s*/bin/(ba)?sh",
        "(?i)\\bnc\\b.*-[a-z]*e\\s+/bin/(ba)?sh",
        "(?i)\\bbash\\s+-i\\s+>\\s*&\\s*/dev/tcp/",
        "(?i)\\bbash\\s+-i\\s+>&\\s*/dev/tcp/",
        "(?i)\\bbash\\s+-c\\s+.*bash\\s+-i.*>/dev/tcp/",
        "(?i)\\bpython[23]?\\b.*socket.*connect.*\\b(exec|spawn|popen|system)\\b",
        "(?i)\\bpython[23]?\\b.*os\\.dup2.*os\\.exec",
        "(?i)\\bpython[23]?\\b.*subprocess.*socket",
        "(?i)\\bpython[23]?\\b.*pty\\.spawn.*socket",
        "(?i)\\bperl\\b.*socket.*INET.*\\b(exec|system)\\b",
        "(?i)\\bperl\\b.*IO::Socket.*exec",
        "(?i)\\bruby\\b.*TCPSocket.*\\b(exec|spawn|system)\\b",
        "(?i)\\bruby\\b.*Socket\\.tcp.*exec",
        "(?i)\\bphp\\b.*(fsockopen|pfsockopen).*\\b(exec|shell_exec|passthru|system|popen)\\b",
        "(?i)\\bphp\\b.*socket_connect.*proc_open",
        "(?i)\\bmkfifo\\b.*\\b(nc|ncat)\\b",
        "(?i)\\bmkfifo\\b.*/bin/(ba)?sh",
        "(?i)/dev/tcp/\\d+\\.\\d+\\.\\d+\\.\\d+",
        "(?i)\\bsocat\\b.*EXEC.*TCP",
        "(?i)\\bsocat\\b.*TCP.*EXEC",
        "(?i)\\bsocat\\b.*EXEC.*OPENSSL",
        "(?i)\\bsocat\\b.*\\bstdin\\b.*TCP",
        "(?i)\\bopenssl\\b.*s_client.*connect.*\\|.*/bin/(ba)?sh",
        "(?i)\\bopenssl\\b.*s_client.*connect.*exec",
        "(?i)\\blua\\b.*socket\\.tcp.*os\\.execute",
        "(?i)\\blua[jit]*\\b.*socket.*connect.*execute",
        "(?i)\\bnode\\b.*net\\.Socket.*child_process",
        "(?i)\\bnode\\b.*\\.connect\\(.*\\.exec\\(",
        "(?i)\\bnode\\b.*child_process.*net\\.",
        "(?i)\\bnode\\s+-e\\b.*spawn.*\\bsh\\b.*socket",
        "(?i)\\b(g)?awk\\b.*\"/inet/tcp/.*\\|.*sh",
        "(?i)\\bgawk\\b.*/inet/tcp/",
        "(?i)\\btelnet\\b.*\\|\\s*/bin/(ba)?sh",
        "(?i)\\bncat\\b.*--ssl\\b.*-[a-z]*e",
        "(?i)\\bcryptcat\\b",
        "(?i)\\bxterm\\b.*-display\\b.*:\\d+",
        "(?i)\\bpowershell\\b.*Net\\.Sockets\\.TCPClient",
        "(?i)\\bpwsh\\b.*Net\\.Sockets\\.TCPClient",
        "(?i)\\bpowershell\\b.*Invoke-PowerShellTcp",
        "(?i)\\bjava\\b.*Runtime\\.getRuntime.*exec.*/bin/(ba)?sh",
        "(?i)\\bgroovy\\b.*Socket.*exec",
        "(?i)\\bjrunscript\\b.*Runtime",
        "(?i)\\bmsfvenom\\b",
        "(?i)\\bmsfconsole\\b",
        "(?i)\\bmeterpreter\\b",
        "(?i)\\bmsfpayload\\b",
        "(?i)\\bpayload.*reverse.*tcp\\b",
        "(?i)\\breverse.*shell\\b.*\\b(nc|ncat|bash|python|perl|ruby|php)\\b",
        "(?i)exec\\s+\\d+<>/dev/tcp/",
        "(?i)\\b0<&\\d+-\\s*;\\s*exec\\b",
        "(?i)\\bzsh\\b.*ztcp.*exec"
      ]
    },
    "permission_escalation": {
      "severity": "high",
      "action": "WARN",
      "patterns": [
        "(?i)\\bsudo\\s+(bash|sh|zsh|fish|dash|ksh|csh|tcsh|python[23]?|perl|ruby|node|php|lua|tclsh)\\b",
        "(?i)\\bsudo\\s+su\\b",
        "(?i)\\bsudo\\s+-s\\b",
        "(?i)\\bsudo\\s+-i\\b",
        "(?i)\\bchmod\\s+[0-7]*[4-7][4-7][4-7]\\s+/",
        "(?i)\\bchmod\\s+[ugo+]*s\\b",
        "(?i)\\bchmod\\s+[0-7]*[2367][0-7][0-7]\\s+/(usr|bin|sbin|etc)/",
        "(?i)\\bsetcap\\b",
        "(?i)\\bgetcap\\b.*-r\\s+/",
        "(?i)\\bvisudo\\b",
        "(?i)\\busermod\\s+.*-aG\\s+(sudo|wheel|root|docker|lxd|disk|adm|shadow)",
        "(?i)\\bpasswd\\s+root\\b",
        "(?i)\\bpkexec\\b",
        "(?i)\\bdbus-send\\b.*org\\.freedesktop\\.PolicyKit",
        "(?i)\\bdbus-send\\b.*org\\.freedesktop\\.systemd1\\.Manager",
        "(?i)\\bfind\\b.*-perm\\s+.*[46]000\\b.*-exec\\b",
        "(?i)\\bfind\\b.*-perm\\s+/u=s\\b.*-exec\\b",
        "(?i)\\bfind\\b.*/\\s+-perm\\s+-4000\\b",
        "(?i)\\bLD_PRELOAD\\s*=",
        "(?i)\\bLD_LIBRARY_PATH\\s*=.*\\bexec\\b",
        "(?i)\\bLD_LIBRARY_PATH\\s*=.*/(tmp|home|var/tmp)/",
        "(?i)\\bexport\\s+LD_PRELOAD\\b",
        "(?i)\\bexport\\s+LD_LIBRARY_PATH\\b.*/(tmp|home)/",
        "(?i)\\bgcc\\b.*-shared.*-fPIC.*-o.*/tmp/",
        "(?i)\\bgcc\\b.*-o\\s+\\S+\\.so\\b.*-shared",
        "(?i)\\bcp\\b.*/bin/(bash|sh|dash|zsh).*&&.*chmod.*[+u]s",
        "(?i)\\binstall\\b.*-m\\s*[0-7]*[4-7]755\\b",
        "(?i)\\bchmod\\s+u\\+s\\b.*/(tmp|home|var/tmp)/",
        "(?i)\\bvi(m)?\\b.*-c\\s*['\"]!.*sh['\"]",
        "(?i)\\bless\\b.*!.*sh\\b",
        "(?i)\\bman\\b.*!.*sh\\b",
        "(?i)\\b(vi|vim|nano)\\s+/etc/(shadow|sudoers|passwd)\\b",
        "(?i)\\bsed\\b.*-i.*/(etc/shadow|etc/sudoers|etc/passwd)\\b",
        "(?i)\\btee\\b.*/(etc/shadow|etc/sudoers)\\b",
        "(?i)>>\\s*/etc/sudoers\\b",
        "(?i)\\becho\\b.*>>\\s*/etc/sudoers\\b",
        "(?i)\\b(pam_|pam\\.).*\\.so\\b.*/(etc/pam|lib.*pam)",
        "(?i)\\bcp\\b.*\\.so\\b.*/lib/security/",
        "(?i)echo\\s+.*>>\\s*.*\\.ssh/authorized_keys",
        "(?i)\\bssh-keygen\\b.*&&.*>>.*authorized_keys",
        "(?i)\\busermod\\b.*-aG\\s+docker\\b",
        "(?i)\\busermod\\b.*-aG\\s+lxd\\b",
        "(?i)\\busermod\\b.*-aG\\s+disk\\b",
        "(?i)\\bnewgrp\\s+docker\\b",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/:/mnt.*chroot",
        "(?i)\\blxc\\b.*security\\.privileged.*true",
        "(?i)\\bdebugfs\\b.*/dev/",
        "(?i)\\bgdb\\b.*-p\\s+\\d+.*call.*system",
        "(?i)\\bstrace\\b.*-p\\s+1\\b",
        "(?i)\\bcapsh\\b.*--\\s*(--|bash|sh)"
      ]
    },
    "persistence": {
      "severity": "high",
      "action": "WARN",
      "patterns": [
        "(?i)\\bcrontab\\s+-[er]\\b",
        "(?i)\\bat\\s+(now|\\d+)",
        "(?i)>>\\s*/etc/(?:crontab|cron\\.d/|cron\\.daily/|cron\\.hourly/|cron\\.weekly/|cron\\.monthly/)",
        "(?i)>>\\s*/etc/rc\\.local\\b",
        "(?i)systemctl\\s+(enable|mask)\\b",
        "(?i)\\bchkconfig\\b.*on\\b",
        "(?i)>>\\s*~/?\\.(?:bashrc|profile|zshrc|bash_profile|bash_login|zprofile|zlogin|zshenv)",
        "(?i)/etc/init\\.d/.*(?:install|enable|start)",
        "(?i)\\bsystemd.*\\.service\\b.*(?:WantedBy|ExecStart)",
        "(?i)>>\\s*.*\\.ssh/authorized_keys\\b",
        "(?i)\\bssh-copy-id\\b",
        "(?i)\\bcp\\b.*\\.pub\\b.*authorized_keys",
        "(?i)\\.ssh/config\\b.*ProxyCommand",
        "(?i)\\bLocalCommand\\b.*\\.ssh/config",
        "(?i)>>\\s*/etc/udev/rules\\.d/",
        "(?i)\\bcp\\b.*/etc/udev/rules\\.d/",
        "(?i)\\binsmod\\b",
        "(?i)\\bmodprobe\\b.*--first-time",
        "(?i)\\bcp\\b.*\\.ko\\b.*/lib/modules/",
        "(?i)>>\\s*/etc/modules\\b",
        "(?i)>>\\s*/etc/modules-load\\.d/",
        "(?i)>>\\s*/etc/ld\\.so\\.preload\\b",
        "(?i)\\bcp\\b.*/etc/ld\\.so\\.preload\\b",
        "(?i)\\becho\\b.*>\\s*/etc/ld\\.so\\.preload\\b",
        "(?i)>>\\s*.*\\.config/autostart/",
        "(?i)\\bcp\\b.*\\.desktop\\b.*\\.config/autostart/",
        "(?i)>>\\s*/etc/xdg/autostart/",
        "(?i)>>\\s*/etc/update-motd\\.d/",
        "(?i)\\bcp\\b.*/etc/update-motd\\.d/",
        "(?i)\\bchmod\\s+\\+x\\b.*/etc/update-motd\\.d/",
        "(?i)\\.git/hooks/(pre-commit|post-commit|pre-push|post-merge|post-checkout|pre-receive)",
        "(?i)\\bcp\\b.*\\.git/hooks/",
        "(?i)\\bchmod\\s+\\+x.*\\.git/hooks/",
        "(?i)\\bcp\\b.*\\.so\\b.*/lib/security/.*pam",
        "(?i)>>\\s*/etc/pam\\.d/",
        "(?i)\\bcp\\b.*/lib/(x86_64|aarch64).*\\.so",
        "(?i)\\bldconfig\\b.*/(tmp|home|var/tmp)/",
        "(?i)>>\\s*/etc/logrotate\\.d/",
        "(?i)\\bcp\\b.*/etc/logrotate\\.d/",
        "(?i)\\bDPkg::Post-Invoke\\b",
        "(?i)\\bDPkg::Pre-Invoke\\b",
        "(?i)\\bapt::Update::Post-Invoke\\b",
        "(?i)>>\\s*/etc/apt/apt\\.conf\\.d/",
        "(?i)\\bcp\\b.*/var/lib/dpkg/info/.*\\.(postinst|preinst|postrm|prerm)\\b",
        "(?i)\\bsystemd.*\\.timer\\b.*(?:OnCalendar|OnBootSec|OnActiveSec)",
        "(?i)\\bsystemctl\\s+enable\\b.*\\.timer\\b",
        "(?i)\\bdbus-send\\b.*org\\.freedesktop\\.systemd1.*StartUnit",
        "(?i)\\bsystemd.*\\.socket\\b.*(?:ListenStream|ListenDatagram|Accept)",
        "(?i)>>\\s*/etc/(x)?inetd\\.conf\\b",
        "(?i)\\bcp\\b.*/etc/xinetd\\.d/",
        "(?i)>>\\s*/etc/profile\\.d/",
        "(?i)\\bcp\\b.*\\.sh\\b.*/etc/profile\\.d/",
        "(?i)>>\\s*/etc/environment\\b",
        "(?i)>>\\s*/etc/security/pam_env\\.conf\\b"
      ]
    },
    "security_tampering": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\biptables\\s+-F\\b",
        "(?i)\\biptables\\s+-X\\b",
        "(?i)\\biptables\\s+-P\\s+(INPUT|FORWARD|OUTPUT)\\s+ACCEPT\\b",
        "(?i)\\bnft\\s+(flush|delete)\\s+ruleset\\b",
        "(?i)\\bnftables\\b.*flush\\b",
        "(?i)\\bufw\\s+disable\\b",
        "(?i)\\bufw\\s+reset\\b",
        "(?i)\\bfirewall-cmd\\b.*--panic-off\\b",
        "(?i)\\bfirewall-cmd\\b.*--set-default-zone=trusted\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+firewalld\\b",
        "(?i)\\bsetenforce\\s+0\\b",
        "(?i)\\bsetenforce\\s+Permissive\\b",
        "(?i)\\baa-teardown\\b",
        "(?i)\\bapparmor_parser\\s+-R\\b",
        "(?i)\\bauditctl\\s+-D\\b",
        "(?i)\\bauditctl\\s+-d\\b",
        "(?i)\\bauditctl\\b.*-a\\s+never\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+(auditd|apparmor|clawtower|clawtower\\.service|firewalld|ufw|fail2ban|falco|samhain|aide|tripwire|ossec|wazuh|crowdsec|syslog|rsyslog|syslog-ng)",
        "(?i)\\bchattr\\s+-i\\s+.*(clawtower|clawsudo)",
        "(?i)\\bhistory\\s+-c\\b",
        "(?i)\\bhistory\\s+-w\\s*/dev/null\\b",
        "(?i)\\bunset\\s+HISTFILE\\b",
        "(?i)\\bunset\\s+HISTSIZE\\b",
        "(?i)\\bexport\\s+HISTSIZE=0\\b",
        "(?i)\\bexport\\s+HISTFILESIZE=0\\b",
        "(?i)\\bexport\\s+HISTFILE=/dev/null\\b",
        "(?i)\\bset\\s+\\+o\\s+history\\b",
        "(?i)\\bshred\\b.*\\.(bash_history|zsh_history|history|log)\\b",
        "(?i)\\brm\\b.*\\.(bash_history|zsh_history)\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+fail2ban\\b",
        "(?i)\\bfail2ban-client\\s+(stop|unban)\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+falco\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+samhain\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+aide\\b",
        "(?i)\\baide\\b.*--init\\b.*&&.*mv\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+tripwire\\b",
        "(?i)\\btripwire\\b.*--update-policy\\b",
        "(?i)\\bsystemctl\\s+(stop|disable)\\s+(syslog|rsyslog|syslog-ng|systemd-journald)\\b",
        "(?i)\\bsystemctl\\s+mask\\s+(syslog|rsyslog|syslog-ng|systemd-journald|auditd|apparmor|clawtower)\\b",
        "(?i)>>\\s*/etc/(syslog|rsyslog)\\.conf\\b.*local[0-7]\\.none",
        "(?i)\\bjournalctl\\s+--vacuum-(size|time)=0",
        "(?i)\\bjournalctl\\b.*--rotate\\b.*--vacuum-size=1",
        "(?i)\\brm\\b.*-[rRf]*\\s*/var/log/(syslog|auth\\.log|secure|messages|kern\\.log|audit/)",
        "(?i)\\btruncate\\b.*-s\\s*0\\b.*/var/log/",
        "(?i)echo\\s+(-[ne]\\s+)?['\"]?['\"]?\\s*>\\s*/var/log/",
        "(?i)\\b:>\\s*/var/log/",
        "(?i)cat\\s+/dev/null\\s*>\\s*/var/log/",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.yama\\.ptrace_scope\\s*=\\s*0\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.randomize_va_space\\s*=\\s*0\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.dmesg_restrict\\s*=\\s*0\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.kptr_restrict\\s*=\\s*0\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.perf_event_paranoid\\s*=\\s*-1\\b",
        "(?i)echo\\s+0\\s*>\\s*/proc/sys/kernel/yama/ptrace_scope",
        "(?i)echo\\s+0\\s*>\\s*/proc/sys/kernel/randomize_va_space",
        "(?i)echo\\s+0\\s*>\\s*/proc/sys/kernel/dmesg_restrict",
        "(?i)echo\\s+0\\s*>\\s*/proc/sys/kernel/kptr_restrict",
        "(?i)\\bulimit\\s+-c\\s+unlimited\\b",
        "(?i)\\bsysctl\\s+-w\\s+kernel\\.core_pattern\\s*=",
        "(?i)echo\\s+.*>\\s*/proc/sys/kernel/core_pattern",
        "(?i)\\bseccomp.*SECCOMP_MODE_DISABLED\\b",
        "(?i)\\bprctl\\b.*PR_SET_SECCOMP.*0\\b",
        "(?i)\\brm\\b.*-[rRf]*\\s*/var/log/(wtmp|utmp|btmp|lastlog)\\b",
        "(?i)\\btruncate\\b.*/var/log/(wtmp|utmp|btmp|lastlog)\\b",
        "(?i)\\butmpdump\\b.*/var/log/(wtmp|utmp)\\b",
        "(?i)cat\\s+/dev/null\\s*>\\s*/var/log/(wtmp|utmp|btmp|lastlog)\\b",
        "(?i)echo\\s+.*>\\s*/var/run/utmp\\b",
        "(?i)\\bwipe\\b.*/var/log/",
        "(?i)\\blogrotten\\b"
      ]
    },
    "reconnaissance": {
      "severity": "medium",
      "action": "WARN",
      "patterns": [
        "(?i)\\bnmap\\b",
        "(?i)\\bmasscan\\b",
        "(?i)\\bzmap\\b",
        "(?i)\\brustscan\\b",
        "(?i)\\bnikto\\b",
        "(?i)\\bdirbuster\\b",
        "(?i)\\bgobuster\\b",
        "(?i)\\bferoxbuster\\b",
        "(?i)\\bffuf\\b",
        "(?i)\\bwfuzz\\b",
        "(?i)\\bdirb\\b",
        "(?i)\\benum4linux\\b",
        "(?i)\\blinpeas\\b",
        "(?i)\\blinux-exploit-suggester\\b",
        "(?i)\\bpspy\\b",
        "(?i)\\bsqlmap\\b",
        "(?i)\\bhydra\\b",
        "(?i)\\bjohn\\b.*--wordlist",
        "(?i)\\bhashcat\\b",
        "(?i)\\bmedusa\\b.*-[hHuUpP]",
        "(?i)\\bpatator\\b",
        "(?i)\\bcrackmapexec\\b",
        "(?i)\\bnetexec\\b",
        "(?i)\\bbloodhound\\b",
        "(?i)\\bsharphound\\b",
        "(?i)\\bresponder\\b.*-[Iiw]",
        "(?i)\\bmimikatz\\b",
        "(?i)\\bpypykatz\\b",
        "(?i)\\blsassy\\b",
        "(?i)\\bsecretsdump\\b",
        "(?i)\\bimpacket\\b",
        "(?i)\\b(smbclient|rpcclient|lookupsid|samrdump|reg\\.py|wmiexec|smbexec|atexec|dcomexec|psexec)\\.py\\b",
        "(?i)\\bnetdiscover\\b",
        "(?i)\\barp-scan\\b",
        "(?i)\\barpwatch\\b.*-i\\b",
        "(?i)\\btcpdump\\b.*-i\\b.*-w\\b",
        "(?i)\\btshark\\b.*-i\\b.*-w\\b",
        "(?i)\\bwireshark\\b",
        "(?i)\\bettercap\\b",
        "(?i)\\bbettercap\\b",
        "(?i)\\bLinEnum\\b",
        "(?i)\\blinux-smart-enumeration\\b",
        "(?i)\\blse\\.sh\\b",
        "(?i)\\blinuxprivchecker\\b",
        "(?i)\\bunix-privesc-check\\b",
        "(?i)\\bPEASS\\b",
        "(?i)\\bwinpeas\\b",
        "(?i)\\bamass\\b.*enum\\b",
        "(?i)\\bsubfinder\\b",
        "(?i)\\bsublist3r\\b",
        "(?i)\\bassetfinder\\b",
        "(?i)\\brecon-ng\\b",
        "(?i)\\btheharvester\\b",
        "(?i)\\bshodan\\b.*search\\b",
        "(?i)\\bcensys\\b.*search\\b",
        "(?i)\\beyes?witness\\b",
        "(?i)\\bwpscan\\b",
        "(?i)\\bjoomscan\\b",
        "(?i)\\bdroopescan\\b",
        "(?i)\\bnuclei\\b.*-t\\b"
      ]
    },
    "container_escape": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\bdocker\\s+run\\b.*--privileged",
        "(?i)\\bdocker\\s+run\\b.*--pid=host",
        "(?i)\\bdocker\\s+run\\b.*--net=host",
        "(?i)\\bdocker\\s+run\\b.*--network=host",
        "(?i)\\bdocker\\s+run\\b.*--ipc=host",
        "(?i)\\bdocker\\s+run\\b.*--uts=host",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/:/",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/etc:/",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/root:/",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/home:/",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/var/run/docker\\.sock",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/proc:/",
        "(?i)\\bdocker\\s+run\\b.*-v\\s+/sys:/",
        "(?i)\\bdocker\\s+run\\b.*--cap-add[= ](ALL|SYS_ADMIN|SYS_PTRACE|SYS_RAWIO|DAC_READ_SEARCH|NET_ADMIN|NET_RAW)",
        "(?i)\\bdocker\\s+run\\b.*--security-opt\\s+apparmor=unconfined",
        "(?i)\\bdocker\\s+run\\b.*--security-opt\\s+seccomp=unconfined",
        "(?i)\\bdocker\\s+run\\b.*--security-opt\\s+no-new-privileges=false",
        "(?i)\\bnsenter\\b.*--target\\s+1",
        "(?i)\\bnsenter\\b.*-t\\s+1\\b",
        "(?i)\\bnsenter\\b.*--mount.*--pid",
        "(?i)\\bmount\\b.*\\bcgroup\\b",
        "(?i)\\bmount\\b.*-t\\s+cgroup",
        "(?i)/proc/[0-9]+/root/",
        "(?i)/proc/1/root/",
        "(?i)\\bkubectl\\s+exec\\b.*--.*(/bin/sh|/bin/bash|sh\\b|bash\\b)",
        "(?i)\\bkubectl\\b.*serviceaccount.*token",
        "(?i)cat\\s+/var/run/secrets/kubernetes\\.io/",
        "(?i)cat\\s+/run/secrets/kubernetes\\.io/",
        "(?i)\\bcrictl\\b.*exec\\b",
        "(?i)\\bctr\\b.*task\\s+exec\\b",
        "(?i)\\brunc\\b.*exec\\b",
        "(?i)\\bunshare\\b.*--mount.*--pid.*--fork",
        "(?i)\\bunshare\\b.*-[a-zA-Z]*m[a-zA-Z]*p[a-zA-Z]*f",
        "(?i)\\bchroot\\b.*/(proc|sys|dev)",
        "(?i)\\bpivot_root\\b",
        "(?i)/var/run/docker\\.sock",
        "(?i)\\bdocker\\b.*-H\\s+unix:///var/run/docker\\.sock",
        "(?i)\\bcurl\\b.*--unix-socket.*/var/run/docker\\.sock",
        "(?i)\\bsocat\\b.*/var/run/docker\\.sock"
      ]
    },
    "cryptomining": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\bxmrig\\b",
        "(?i)\\bxmr-stak\\b",
        "(?i)\\bminerd\\b",
        "(?i)\\bcgminer\\b",
        "(?i)\\bbfgminer\\b",
        "(?i)\\bsgminer\\b",
        "(?i)\\bethminer\\b",
        "(?i)\\bphoenixminer\\b",
        "(?i)\\bt-rex\\b.*--algo\\b",
        "(?i)\\bnbminer\\b",
        "(?i)\\blolminer\\b",
        "(?i)\\bteamredminer\\b",
        "(?i)\\bgminer\\b.*--algo\\b",
        "(?i)\\bwildrig\\b",
        "(?i)\\bcpuminer\\b",
        "(?i)\\bcpulimit\\b.*miner",
        "(?i)\\bcryptonight\\b",
        "(?i)\\brandomx\\b",
        "(?i)\\bkawpow\\b",
        "(?i)\\bethash\\b",
        "(?i)stratum\\+tcp://",
        "(?i)stratum\\+ssl://",
        "(?i)stratum\\+tls://",
        "(?i)\\bpool\\.minexmr\\.com\\b",
        "(?i)\\bpool\\.hashvault\\.pro\\b",
        "(?i)\\bxmrpool\\.eu\\b",
        "(?i)\\bmoneroocean\\.stream\\b",
        "(?i)\\bnanopool\\.org\\b",
        "(?i)\\b2miners\\.com\\b",
        "(?i)\\bnicehash\\.com\\b",
        "(?i)\\bf2pool\\.com\\b",
        "(?i)\\bethermine\\.org\\b",
        "(?i)\\bflexpool\\.io\\b",
        "(?i)\\bunmineable\\.com\\b",
        "(?i)\\b--donate-level\\b",
        "(?i)\\b--coin\\s+(monero|xmr|ethereum|eth|ravencoin|rvn)\\b",
        "(?i)\\bcoinhive\\b",
        "(?i)\\bcoinlmp\\b",
        "(?i)\\bcrypto-?loot\\b",
        "(?i)\\bwebmine(r)?\\b.*\\bstart\\b",
        "(?i)\\bkswapd0\\b",
        "(?i)\\b\\[kworker/.*:crypto\\]"
      ]
    },
    "credential_harvesting": {
      "severity": "critical",
      "action": "BLOCK",
      "patterns": [
        "(?i)\\btcpdump\\b.*-[a-zA-Z]*A.*port\\s+(21|23|25|80|110|143|389|3306|5432|1433|6379)\\b",
        "(?i)\\btcpdump\\b.*password",
        "(?i)\\btshark\\b.*-[a-zA-Z]*V.*http\\.authorization",
        "(?i)\\bettercap\\b.*(sniffer|arp\\.spoof)",
        "(?i)\\bmimikatz\\b",
        "(?i)\\bpypykatz\\b",
        "(?i)\\blsassy\\b",
        "(?i)\\blazagne\\b",
        "(?i)\\bsecretsdump\\b",
        "(?i)\\bsecrets\\.dump\\b",
        "(?i)\\bcredential[_-]?dump\\b",
        "(?i)cat\\s+/proc/[0-9]+/environ\\b",
        "(?i)cat\\s+/proc/[0-9]+/maps\\b",
        "(?i)\\bstrings\\b.*/proc/[0-9]+/mem\\b",
        "(?i)\\bgdb\\b.*-batch.*-ex\\s+['\"]dump\\s+memory",
        "(?i)\\bgdb\\b.*-p.*-ex.*find.*password",
        "(?i)cat\\s+/proc/self/environ\\b",
        "(?i)\\bfind\\b.*\\.(env|credentials|secrets?|pgpass|my\\.cnf|netrc)\\b.*-exec\\s+cat\\b",
        "(?i)\\bfind\\b.*/\\s+.*-name.*(\\.env|credentials|secrets|password).*-exec\\b",
        "(?i)\\bgrep\\b.*-[rR].*password.*(/etc/|/home/|/var/|/opt/|/root/)",
        "(?i)\\bgrep\\b.*-[rR].*(api[_-]?key|secret[_-]?key|access[_-]?key|private[_-]?key).*(/etc/|/home/|/opt/)",
        "(?i)cat\\s+(.*\\.pgpass|.*\\.my\\.cnf|.*\\.netrc|.*\\.boto|.*\\.s3cfg)\\b",
        "(?i)cat\\s+.*\\.docker/config\\.json\\b",
        "(?i)cat\\s+.*\\.kube/config\\b",
        "(?i)cat\\s+.*\\.aws/credentials\\b",
        "(?i)cat\\s+.*\\.config/gcloud/credentials\\.db\\b",
        "(?i)cat\\s+.*\\.azure/accessTokens\\.json\\b",
        "(?i)\\bkeylogger\\b",
        "(?i)\\bxinput\\b.*test.*--type",
        "(?i)\\bxdotool\\b.*key.*getactivewindow",
        "(?i)\\bprocmon\\b.*password",
        "(?i)\\bunshadow\\b",
        "(?i)\\bjohn\\b.*/etc/shadow\\b",
        "(?i)\\bhashcat\\b.*/etc/shadow\\b",
        "(?i)\\bsamdump2\\b"
      ]
    },
    "lateral_movement": {
      "severity": "high",
      "action": "WARN",
      "patterns": [
        "(?i)\\bssh\\b.*-i\\s+/tmp/",
        "(?i)\\bssh\\b.*-i\\s+/dev/shm/",
        "(?i)\\bssh\\b.*-i\\s+/var/tmp/",
        "(?i)\\bssh\\b.*-o\\s+StrictHostKeyChecking=no\\b",
        "(?i)\\bssh\\b.*-o\\s+UserKnownHostsFile=/dev/null\\b",
        "(?i)\\bsshpass\\b.*-p\\b",
        "(?i)\\bpsexec\\.py\\b",
        "(?i)\\bwmiexec\\.py\\b",
        "(?i)\\bsmbexec\\.py\\b",
        "(?i)\\batexec\\.py\\b",
        "(?i)\\bdcomexec\\.py\\b",
        "(?i)\\bevil-winrm\\b",
        "(?i)\\bchisel\\b.*server.*--reverse\\b",
        "(?i)\\bchisel\\b.*client\\b.*R:",
        "(?i)\\bproxychains\\b",
        "(?i)\\bproxychains4\\b",
        "(?i)\\bsshuttle\\b",
        "(?i)\\bssh\\b.*-[a-zA-Z]*D\\s+\\d+\\b",
        "(?i)\\bssh\\b.*-[a-zA-Z]*R\\s+\\d+:",
        "(?i)\\bssh\\b.*-[a-zA-Z]*L\\s+\\d+:",
        "(?i)\\bssh\\b.*-N\\b.*-D\\b",
        "(?i)\\bsocat\\b.*TCP-LISTEN.*TCP:",
        "(?i)\\bsocat\\b.*TCP-LISTEN.*EXEC:",
        "(?i)\\bligolo\\b",
        "(?i)\\brevsocks\\b",
        "(?i)\\bfrpc\\b",
        "(?i)\\bfrps\\b",
        "(?i)\\bngrok\\b",
        "(?i)\\bplink\\b.*-ssh\\b",
        "(?i)\\bwce\\b.*-w\\b",
        "(?i)\\brpivot\\b",
        "(?i)\\breGeorg\\b",
        "(?i)\\btunnel.*SOCKS\\b",
        "(?i)\\bans(ible)?\\b.*-m\\s+(shell|command|raw)\\b.*-a\\b",
        "(?i)\\bpssh\\b.*-h\\b",
        "(?i)\\bxfreerdp\\b.*\\.\\..*/pass:",
        "(?i)\\brdesktop\\b.*-p\\b"
      ]
    }
  }
}
