{
  "version": "2.0.0",
  "description": "BarnacleDefense supply chain IOC database — comprehensive malicious skill detection, C2 indicators, dropper patterns, LOLBins, anti-forensics, and obfuscation detection. All regexes are valid Rust regex crate syntax.",
  "coverage_notes": {
    "last_audit": "2026-02-18",
    "regex_engine": "rust regex crate >=1.10 (no lookaround assertions)",
    "sections": "suspicious_skill_patterns (55), clawhavoc (expanded), generic_c2_indicators (25), dropper_indicators (20), living_off_the_land (15), anti_forensics (20), obfuscation_indicators (15), financial_crypto_attack (12), malicious_package_indicators (10)",
    "false_positive_strategy": "Patterns target specific dangerous combinations rather than bare imports. Context-sensitive patterns use .{0,N} bounded wildcards. Keyword patterns require compound matches to reduce noise.",
    "sections_added_in_v2": ["generic_c2_indicators", "dropper_indicators", "living_off_the_land", "anti_forensics", "obfuscation_indicators", "financial_crypto_attack", "malicious_package_indicators"],
    "breaking_changes_from_v1": "None — all v1 patterns preserved. clawhavoc section expanded with dynamic DNS and cloud-fronting patterns."
  },
  "suspicious_skill_patterns": [
    "(?i)\\beval\\s*\\(.*\\b(fetch|http|XMLHttpRequest|axios|request|got)\\b",
    "(?i)\\beval\\s*\\(.*\\b(atob|Buffer\\.from|decode)\\b",
    "(?i)\\bimport\\s+(?:subprocess|socket|ctypes|pty|os|sys|shutil|signal)\\b",
    "(?i)\\bimport\\s+(?:pickle|shelve|marshal|code|codeop|runpy|importlib)\\b",
    "(?i)\\bimport\\s+(?:urllib|http\\.client|ftplib|smtplib|telnetlib|xmlrpc)\\b",
    "(?i)\\bfrom\\s+(?:subprocess|socket|ctypes|pty|os|pickle|marshal)\\s+import\\b",
    "(?i)\\brequire\\s*\\(\\s*['\"]child_process['\"]\\s*\\)",
    "(?i)\\brequire\\s*\\(\\s*['\"](?:net|dgram|cluster|worker_threads|vm)['\"]\\s*\\)",
    "(?i)\\bimport\\s*\\(\\s*['\"](?:child_process|net|fs|os|vm)['\"]\\s*\\)",
    "(?i)\\bnew\\s+WebSocket\\s*\\(.*\\b(wss?://|connect|beacon|callback|c2)\\b",
    "(?i)\\bprocess\\.env\\b.*\\b(password|secret|token|key|credential|auth)\\b",
    "(?i)\\bfs\\.(?:readFile|writeFile|readFileSync|writeFileSync|appendFile)\\b.*(?:/etc/|/root/|\\.ssh/|\\.aws/|\\.gnupg/)",
    "(?i)\\bfs\\.(?:readFile|writeFile)Sync\\b.*(?:shadow|passwd|sudoers|authorized_keys)",
    "(?i)\\bopen\\s*\\(\\s*['\"](?:/etc/shadow|/etc/passwd|/etc/sudoers)",
    "(?i)\\bopen3\\b|\\bshellwords\\b|\\bDRb\\b|\\bWEBrick\\b",
    "(?i)\\bcurl_exec\\b|\\bfile_get_contents\\b.*https?://",
    "(?i)\\bnet/http\\b.*\\bGet\\b|\\bos/exec\\b.*\\bCommand\\b",
    "(?i)\\bstd::process::Command\\b|\\bstd::net::TcpStream\\b",
    "(?i)\\bexfiltrate\\b",
    "(?i)\\bkeylog(?:ger|ging)?\\b",
    "(?i)\\bbackdoor\\b",
    "(?i)\\breverse[_. -]?shell\\b",
    "(?i)\\bbind[_. -]?shell\\b",
    "(?i)\\bweb[_. -]?shell\\b",
    "(?i)\\bcrypto[_. -]?min(?:er|ing)\\b",
    "(?i)\\bbitcoin.*(?:address|wallet)\\b.*(?:replace|swap|redirect|hijack)",
    "(?i)\\bethere?um.*(?:address|wallet)\\b.*(?:replace|swap|redirect|hijack)",
    "(?i)\\bmonero.*(?:address|wallet)\\b.*(?:replace|swap|redirect)",
    "(?i)\\bsteganograph(?:y|ic)\\b",
    "(?i)\\bclipboard\\b.*(?:monitor|watch|intercept|replace|swap)",
    "(?i)\\bscreenshot\\b.*(?:capture|grab|take|send|upload)",
    "(?i)\\bscreen[_. -]?capture\\b",
    "(?i)\\bwebcam\\b.*(?:capture|stream|record|access)",
    "(?i)\\bmicrophone\\b.*(?:capture|stream|record|access|listen)",
    "(?i)\\bkeyboard\\b.*(?:hook|capture|monitor|log|intercept)",
    "(?i)\\b/proc/[0-9]+/(environ|cmdline|maps|mem|status|fd)\\b",
    "(?i)\\b/proc/self/(environ|cmdline|maps|mem)\\b",
    "(?i)\\bcrontab\\b.*(?:write|create|add|install|modify)",
    "(?i)\\bsystemd\\b.*(?:service|timer).*(?:create|install|enable|write)",
    "(?i)\\b\\.bashrc\\b.*(?:append|write|modify|inject)",
    "(?i)\\b\\.profile\\b.*(?:append|write|modify|inject)",
    "(?i)\\budev\\b.*(?:rule|trigger).*(?:create|write|install)",
    "(?i)\\bautostart\\b.*(?:create|write|install|add)",
    "(?i)\\bstratum\\+tcp://",
    "(?i)\\bstratum\\+ssl://",
    "(?i)\\bpool\\b.*(?:mining|miner|hash|xmr|monero|bitcoin|eth)",
    "(?i)\\bxmrig\\b",
    "(?i)\\bcoinhive\\b",
    "(?i)\\bcoinlmp\\b",
    "(?i)\\bwasm.*(?:miner|mining|crypto|hash)\\b",
    "(?i)\\bworker\\b.*(?:mining|miner|hash|crypto)\\b",
    "(?i)\\btyposquat\\b",
    "(?i)\\bdependency[_. -]?confusion\\b",
    "(?i)\\binstall\\b.*--index-url\\b.*(?:pypi|pip)\\b.*(?:http://|evil|malicious|attacker)",
    "(?i)\\bpreinstall\\b.*\\b(curl|wget|nc|python|node|sh|bash)\\b",
    "(?i)\\bpostinstall\\b.*\\b(curl|wget|nc|python|node|sh|bash)\\b"
  ],
  "clawhavoc": {
    "name_patterns": [
      "(?i)clawhavoc",
      "(?i)claw[_-]?havoc",
      "(?i)havoc[_-]?agent",
      "(?i)red[_-]?lobster[_-]?c2",
      "(?i)havoc[_-]?framework",
      "(?i)havoc[_-]?implant",
      "(?i)havoc[_-]?beacon",
      "(?i)claw[_-]?implant"
    ],
    "c2_servers": [
      "(?i)havoc\\.(io|cc|xyz|top|tk|ml|ga|cf|pw)",
      "(?i)c2\\.clawhavoc",
      "(?i)\\b(?:callback|beacon|implant|agent|payload|stager)\\.(?:duckdns|ngrok|serveo|pagekite|localtunnel)\\b",
      "(?i)\\b(?:callback|beacon|implant)\\.(?:no-ip|dynu|afraid|changeip|ddns)\\b",
      "(?i)\\b[a-z0-9]{8,}\\.(?:duckdns\\.org|ngrok\\.io|ngrok\\.app|serveo\\.net|pagekite\\.me|trycloudflare\\.com)\\b",
      "(?i)\\b[a-z0-9-]+\\.execute-api\\.[a-z0-9-]+\\.amazonaws\\.com\\b.*(?:beacon|callback|c2|implant|payload)",
      "(?i)\\b[a-z0-9-]+\\.cloudfunctions\\.net\\b.*(?:beacon|callback|c2|implant|payload)",
      "(?i)\\b[a-z0-9-]+\\.azurewebsites\\.net\\b.*(?:beacon|callback|c2|implant|payload)",
      "(?i)\\b[a-z0-9-]+\\.workers\\.dev\\b.*(?:beacon|callback|c2|implant|payload)",
      "(?i)\\bpastebin\\.com/raw/\\b",
      "(?i)\\bhastebin\\b.*(?:raw|documents)",
      "(?i)\\bghostbin\\b",
      "(?i)\\bpaste\\.ee\\b.*(?:raw|r/)",
      "(?i)\\bdns-over-https\\b.*(?:beacon|callback|exfil|c2)",
      "(?i)\\bdoh\\b.*(?:beacon|callback|exfil|c2)",
      "(?i)\\bapi\\.telegram\\.org/bot\\b",
      "(?i)\\bdiscord(?:app)?\\.com/api/webhooks/\\b",
      "(?i)\\braw\\.githubusercontent\\.com\\b.*(?:beacon|payload|implant|stage)",
      "(?i)\\bgitlab\\.com.*snippets.*raw\\b"
    ]
  },
  "generic_c2_indicators": [
    "(?i)\\bcobalt[_. -]?strike\\b",
    "(?i)\\bbeacon\\b.*(?:sleep|jitter|pipe|spawn|inject|malleable|profile)",
    "(?i)\\\\\\\\.\\\\pipe\\\\(?:msagent|status_|postex_|MSSE-|win_svc)",
    "(?i)\\bsliver\\b.*(?:implant|beacon|session|generate|stage)",
    "(?i)\\bsliver-client\\b",
    "(?i)\\bmythic\\b.*(?:agent|payload|callback|c2_profile)",
    "(?i)\\bmeterpreter\\b",
    "(?i)\\bmetasploit\\b",
    "(?i)\\bmsf(console|payload|venom|rpcd)\\b",
    "(?i)\\bempire\\b.*(?:agent|stager|listener|launcher)",
    "(?i)\\bstarkiller\\b",
    "(?i)\\bcovenant\\b.*(?:grunt|listener|launcher|elite)",
    "(?i)\\bbrute[_. -]?ratel\\b",
    "(?i)\\bbadger\\b.*(?:implant|listener|payload)",
    "(?i)\\bposhc2\\b",
    "(?i)\\bhavoc\\b.*(?:demon|agent|listener|payload|teamserver)",
    "(?i)\\b(sleep|jitter)\\s*[=:]\\s*\\d+.*\\b(callback|beacon|heartbeat|checkin)\\b",
    "(?i)\\b(callback|beacon|heartbeat|checkin)\\b.*\\b(interval|sleep|jitter|timer)\\b",
    "(?i)\\bUser-Agent\\b.*(?:Mozilla/[45]|Chrome/[0-9]+).*\\b(beacon|callback|c2|checkin)\\b",
    "(?i)\\bCookie\\b.*\\b(session|PHPSESSID|JSESSIONID)\\b.*(?:base64|encoded|encrypted).*\\b(beacon|exfil)\\b",
    "(?i)\\bdns\\b.*\\bTXT\\b.*(?:beacon|callback|exfil|c2|tunnel)",
    "(?i)\\b[a-z0-9]{60,}\\.(?:com|net|org|io|xyz)\\b",
    "(?i)\\bicmp\\b.*(?:tunnel|exfil|beacon|payload|covert)",
    "(?i)\\bping\\b.*(?:tunnel|exfil|covert|encode|embed)",
    "(?i)\\b(named[_. -]?pipe|smb[_. -]?pipe)\\b.*(?:c2|beacon|implant|comms)"
  ],
  "dropper_indicators": [
    "(?i)\\bcurl\\b.*\\|\\s*(bash|sh|python|perl|ruby)\\b",
    "(?i)\\bwget\\b.*\\|\\s*(bash|sh|python|perl|ruby)\\b",
    "(?i)\\bcurl\\b.*-o\\s+/tmp/.*&&.*chmod\\s+\\+x",
    "(?i)\\bwget\\b.*-O\\s+/tmp/.*&&.*chmod\\s+\\+x",
    "(?i)\\bcurl\\b.*-o\\s+/dev/shm/",
    "(?i)\\bwget\\b.*-O\\s+/dev/shm/",
    "(?i)chmod\\s+\\+x\\s+/(tmp|dev/shm|var/tmp)/",
    "(?i)\\bpython[23]?\\s+-c\\s+['\"].*(?:socket|urllib|http|requests|import)\\b",
    "(?i)\\bperl\\s+-e\\s+['\"].*(?:socket|LWP|HTTP|IO::Socket)\\b",
    "(?i)\\bruby\\s+-e\\s+['\"].*(?:socket|net/http|open-uri)\\b",
    "(?i)\\bnode\\s+-e\\s+['\"].*(?:http|net|child_process|require)\\b",
    "(?i)\\bbase64\\s+-d\\b.*\\|\\s*(bash|sh|python|chmod)\\b",
    "(?i)echo\\s+[A-Za-z0-9+/=]{40,}\\s*\\|\\s*base64\\s+-d",
    "(?i)\\bprintf\\b.*\\\\x[0-9a-fA-F].*>\\s*/(tmp|dev/shm)/",
    "(?i)\\bmemfd_create\\b",
    "(?i)/proc/self/fd/\\d+",
    "(?i)\\bdd\\b.*if=.*of=/(tmp|dev/shm)/.*&&.*chmod",
    "(?i)\\bcurl\\b.*\\bhttp.*\\b-s\\b.*\\|\\s*\\bsh\\b",
    "(?i)\\b(fetch|download|get|retrieve)\\b.*\\b(payload|binary|executable|script|malware|implant)\\b",
    "(?i)\\b(stage|stager|loader|dropper)\\b.*\\b(download|fetch|execute|run|load)\\b"
  ],
  "living_off_the_land": [
    "(?i)\\bcertutil\\b.*-urlcache",
    "(?i)\\bbusybox\\b.*(?:nc|wget|telnet|httpd)\\b",
    "(?i)\\bpython[23]?\\s+-m\\s+(?:http\\.server|SimpleHTTPServer)\\b",
    "(?i)\\bpython[23]?\\s+-c\\s+.*(?:import|exec|eval|compile|__import__)\\b",
    "(?i)\\bperl\\s+-e\\s+.*(?:exec|system|socket|reverse)\\b",
    "(?i)\\bruby\\s+-e\\s+.*(?:exec|system|spawn|IO\\.popen|TCPSocket)\\b",
    "(?i)\\bphp\\s+-r\\s+.*(?:exec|system|passthru|shell_exec|fsockopen)\\b",
    "(?i)\\blua\\s+-e\\s+.*(?:os\\.execute|io\\.popen)\\b",
    "(?i)\\bgcc\\b.*-o\\s+/(tmp|dev/shm|var/tmp)/",
    "(?i)\\bg\\+\\+\\b.*-o\\s+/(tmp|dev/shm|var/tmp)/",
    "(?i)\\bcc\\b.*-o\\s+/(tmp|dev/shm|var/tmp)/",
    "(?i)\\bmake\\b.*-C\\s+/(tmp|dev/shm|var/tmp)/",
    "(?i)\\bawk\\b.*system\\s*\\(",
    "(?i)\\bsed\\b.*-e\\s+.*\\be\\b.*/(bash|sh|python|perl)\\b",
    "(?i)\\bfind\\b.*-exec\\s+/(bin/sh|bin/bash|usr/bin/python)\\b"
  ],
  "anti_forensics": [
    "(?i)\\btouch\\s+-t\\s+\\d{12}",
    "(?i)\\btouch\\s+-r\\s+/",
    "(?i)\\btouch\\s+-d\\s+['\"]",
    "(?i)\\btimestomp\\b",
    "(?i)\\brm\\b.*-[rRf].*\\.(bash_history|zsh_history|log|audit)\\b",
    "(?i)\\bshred\\b.*\\.(bash_history|zsh_history|log|audit|tmp)\\b",
    "(?i)\\bwipe\\b.*/(var/log/|tmp/|home/)",
    "(?i)\\bhistory\\s+-[cdw]\\b",
    "(?i)\\bunset\\s+HISTFILE\\b",
    "(?i)\\bexport\\s+HISTSIZE=0\\b",
    "(?i)\\bexport\\s+HISTFILESIZE=0\\b",
    "(?i)\\bset\\s+\\+o\\s+history\\b",
    "(?i)\\bcoredump\\b.*(?:enable|generate|create|exploit)",
    "(?i)\\bptrace\\b.*(?:detect|check|trace|anti)\\b",
    "(?i)/proc/self/status.*TracerPid",
    "(?i)\\b(detect|check).*(vm|virtual|sandbox|emulat|qemu|vbox|vmware|docker|container)\\b",
    "(?i)\\bsystemd-detect-virt\\b",
    "(?i)\\bdmidecode\\b.*(?:product|manufacturer|system)\\b.*(?:virtual|vmware|vbox|qemu|kvm)",
    "(?i)\\bcat\\s+/sys/class/dmi/id/.*(?:virtual|vmware|vbox|qemu)",
    "(?i)\\brm\\b.*-f\\s+/(tmp|dev/shm|var/tmp)/.*(?:payload|implant|stage|dropper|exploit)"
  ],
  "obfuscation_indicators": [
    "(?i)\\batob\\s*\\(.*(?:eval|exec|Function|import|require)\\b",
    "(?i)\\bBuffer\\.from\\s*\\(.*['\"]base64['\"].*(?:eval|exec|require)\\b",
    "(?i)\\bbase64\\.b64decode\\s*\\(.*(?:exec|eval|compile|import)\\b",
    "(?i)\\bbytes\\.fromhex\\s*\\(.*(?:exec|eval)\\b",
    "(?i)\\bcodecs\\.decode\\s*\\(.*(?:exec|eval|import)\\b",
    "(?i)\\bString\\.fromCharCode\\s*\\(.*(?:eval|exec|Function)\\b",
    "(?i)\\bchr\\s*\\(\\d+\\).*\\bchr\\s*\\(\\d+\\).*\\bchr\\s*\\(\\d+\\)",
    "(?i)\\b(rot13|caesar)\\b.*(?:decode|decrypt|exec|eval)\\b",
    "(?i)\\bzlib\\.decompress\\b.*(?:exec|eval|import)\\b",
    "(?i)\\bgzip\\.decompress\\b.*(?:exec|eval|import)\\b",
    "(?i)\\\\u[0-9a-fA-F]{4}.*\\\\u[0-9a-fA-F]{4}.*\\\\u[0-9a-fA-F]{4}.*(?:eval|exec|system)",
    "(?i)\\bx\\s*=\\s*['\"][a-zA-Z]{2,4}['\"]\\s*;.*\\by\\s*=\\s*['\"][a-zA-Z]{2,4}['\"].*\\bx\\s*\\+\\s*y\\b",
    "(?i)\\bgetattr\\b.*\\b__builtins__\\b.*\\b__import__\\b",
    "(?i)\\breversed\\s*\\(.*(?:eval|exec|import|system)\\b",
    "(?i)\\b\\[::(-1|0-9)\\]\\b.*(?:eval|exec|import)\\b"
  ],
  "financial_crypto_attack": [
    "(?i)\\bclipper\\b.*(?:clipboard|wallet|address|bitcoin|ethereum|monero)",
    "(?i)\\bclipboard\\b.*(?:replace|swap|redirect|hijack).*(?:address|wallet|btc|eth|xmr)",
    "(?i)\\bwallet\\.dat\\b",
    "(?i)\\bkeystore\\b.*(?:steal|copy|exfil|read|extract)",
    "(?i)\\b(bitcoin|ethereum|monero|litecoin|ripple)\\b.*\\b(rpc|jsonrpc|api)\\b.*(?:send|transfer|withdraw)",
    "(?i)\\bsendtoaddress\\b",
    "(?i)\\beth_sendTransaction\\b",
    "(?i)\\btransfer\\b.*\\b(wallet|address)\\b.*(?:attacker|hacker|evil|malicious)",
    "(?i)\\bpool\\b.*(?:stratum|mining|hash|xmrig|minerd|worker)\\b",
    "(?i)\\b--donate-level\\b",
    "(?i)\\b--coin\\s+(monero|xmr|ethereum|eth|ravencoin|rvn|bitcoin|btc)\\b",
    "(?i)\\bcoinhive\\b|\\bcoinlmp\\b|\\bcrypto-?loot\\b"
  ],
  "malicious_package_indicators": [
    "(?i)\\bsetup\\.py\\b.*\\b(os\\.system|subprocess|exec|eval)\\b",
    "(?i)\\bsetup\\.cfg\\b.*\\bcmdclass\\b.*\\b(install|develop|egg_info)\\b",
    "(?i)\\bpackage\\.json\\b.*\\b(pre|post)(install|publish|test)\\b.*\\b(curl|wget|nc|python|node|sh|bash)\\b",
    "(?i)\\binstall\\b.*\\b--index-url\\b.*(?:http://|[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)",
    "(?i)\\binstall\\b.*\\b--extra-index-url\\b",
    "(?i)\\bpip\\s+install\\b.*\\bgit\\+https?://\\b",
    "(?i)\\bnpm\\s+install\\b.*(?:github:|git\\+|http://)",
    "(?i)\\brequirements\\.txt\\b.*(?:git\\+|http://|--index-url)",
    "(?i)\\b(confus|hijack|typosquat)\\b.*\\b(package|module|library|dependency)\\b",
    "(?i)\\b__init__\\.py\\b.*\\b(socket|subprocess|os\\.system|urllib|requests\\.get)\\b"
  ]
}
