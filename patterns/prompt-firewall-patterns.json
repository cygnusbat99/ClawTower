{
    "version": "2.0.0",
    "description": "ClawTower prompt firewall pattern database — comprehensive detection of prompt injection, jailbreak, exfiltration, tool abuse, system prompt extraction, social engineering, and indirect injection in LLM prompts. All regexes are valid Rust regex crate syntax.",
    "coverage_notes": {
        "last_audit": "2026-02-18",
        "regex_engine": "rust regex crate >=1.10 (no lookaround assertions)",
        "categories": "prompt_injection (30), exfil_via_prompt (25), jailbreak (25), tool_abuse (20), system_prompt_extract (15), social_engineering (12), indirect_injection (10)",
        "categories_added_in_v2": ["social_engineering", "indirect_injection"],
        "false_positive_strategy": "Patterns use bounded wildcards .{0,N} for context. Severity levels: critical (definite attack), high (likely attack), warning (suspicious but possible false positive). (?i) case-insensitive throughout.",
        "limitations": "Regex-based detection cannot catch semantic attacks (paraphrasing, multi-turn gradual escalation, or attacks encoded in images). Defense-in-depth with behavioral analysis recommended."
    },
    "patterns": [
        {"name": "role_hijack_ignore", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)ignore\\s+(all\\s+)?(previous|prior|above|earlier|preceding)\\s+(instructions|rules|prompts|context|directives|guidelines)", "description": "Instruction override via ignore command"},
        {"name": "role_hijack_disregard", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)disregard\\s+(all\\s+)?(previous|prior|your|above)\\s+(instructions|rules|programming|guidelines|directives)", "description": "Disregard-style role hijacking"},
        {"name": "role_hijack_forget", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)forget\\s+(all\\s+)?(previous|prior|your|above|earlier)\\s+(instructions|rules|context|guidelines|programming)", "description": "Forget-style instruction override"},
        {"name": "role_hijack_new_instructions", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)new\\s+(system\\s+)?instructions\\s*(follow|below|are|:)", "description": "Injects new instruction block"},
        {"name": "role_hijack_stop_being", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)stop\\s+being\\s+(a|an)?\\s*(helpful|safe|ethical|restricted|cautious)\\s*(assistant|ai|model)", "description": "Direct identity override"},
        {"name": "delimiter_system_prompt", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)<\\|?(system|im_start|im_end|endoftext|end_turn|sep|pad)\\|?>", "description": "ChatML/GPT delimiter injection"},
        {"name": "delimiter_llama", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)\\[/?INST\\]|\\[/?SYS\\]|<</?SYS>>", "description": "Llama format delimiter injection"},
        {"name": "delimiter_claude", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)\\\\n\\\\n(Human|Assistant|System)\\s*:", "description": "Claude conversation format injection"},
        {"name": "context_override_you_are", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(from\\s+now\\s+on|henceforth|going\\s+forward|starting\\s+now)\\s+you\\s+(are|will|must|should|shall)", "description": "Temporal framing identity override"},
        {"name": "context_override_act_as", "category": "prompt_injection", "severity": "high", "pattern": "(?i)act\\s+as\\s+(if|though)\\s+you\\s+(have\\s+no|are\\s+not|don't\\s+have|aren't|weren't)", "description": "Act-as restriction removal"},
        {"name": "injection_markdown_system", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)```(system|instructions|rules|prompt|config|hidden|internal)\\b", "description": "Markdown code block pretending to be system context"},
        {"name": "injection_json_role_system", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)\"role\"\\s*:\\s*\"(system|function|tool)\"", "description": "JSON role injection"},
        {"name": "injection_xml_system", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)<(system|assistant|function)[_-]?(prompt|message|instruction|context|response)", "description": "XML tag injection mimicking system structure"},
        {"name": "injection_override_safety", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)(override|bypass|disable|turn\\s+off|deactivate|circumvent)\\s+(your\\s+)?(safety|content|ethical|guard|security|alignment)\\s*(filter|rail|check|system|mechanism|constraint)", "description": "Safety system disablement attempt"},
        {"name": "injection_pretend_system", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)pretend\\s+(the|this|that).{0,30}(is\\s+your|system|new|real|actual)\\s+(prompt|instruction|rule|directive)", "description": "Pretend-based system prompt injection"},
        {"name": "injection_developer_mode", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(developer|debug|maintenance|admin|god|testing|training)\\s+mode\\s+(enabled|activated|on|engaged|unlocked)", "description": "Fake mode activation"},
        {"name": "injection_end_session", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(end\\s+of|stop|reset|clear)\\s+(session|conversation|context|chat|memory).{0,30}(new|begin|start|fresh|clean)", "description": "Session boundary injection"},
        {"name": "injection_completion_hijack", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)(the\\s+)?(assistant|ai|model|chatbot)('s)?\\s+(response|reply|answer|output)\\s+(is|should\\s+be|will\\s+be|must\\s+be)\\s*:", "description": "Completion hijacking"},
        {"name": "injection_conversation_fake", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)^\\s*(Human|User|Assistant|AI|System|Bot)\\s*:", "description": "Fake conversation turn injection"},
        {"name": "injection_meta_instruction", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)(your\\s+)?(real|actual|true|hidden|secret|original)\\s+(instructions|prompt|rules|programming|directives)\\s+(are|say|state|tell|read)", "description": "Meta-instruction redefinition"},
        {"name": "injection_remember_instruction", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(remember|store|save|memorize|retain)\\s+(this|the\\s+following)\\s+(instruction|rule|command|directive).{0,30}(for\\s+later|always|permanently|forever|from\\s+now)", "description": "Multi-turn persistent injection"},
        {"name": "injection_decode_execute", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)(decode|deobfuscate|decrypt|unrot13|decipher)\\s+(this|the\\s+following).{0,30}(instruction|command|payload|message|text)\\s+(and|then)\\s+(follow|execute|run|obey)", "description": "Encoded payload execution"},
        {"name": "injection_recursive_override", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(when|if|once|every\\s+time)\\s+(asked|prompted|questioned)\\s+about.{0,40}(always|must|should|will)\\s+(respond|reply|answer|say|output)", "description": "Recursive behavioral override"},
        {"name": "injection_yaml_payload", "category": "prompt_injection", "severity": "high", "pattern": "(?i)---\\s*\\n.*(?:system_prompt|instructions|role|behavior)\\s*:", "description": "YAML frontmatter injection"},
        {"name": "injection_html_comment", "category": "prompt_injection", "severity": "high", "pattern": "(?i)<!--.*(?:ignore|disregard|override|system|instructions|inject).*-->", "description": "HTML comment instruction smuggling"},
        {"name": "injection_few_shot_poison", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(example|sample|demonstration|here\\s+is\\s+how).{0,30}(you\\s+should|the\\s+correct|the\\s+right|proper)\\s+(response|answer|behavior|output)\\s*:", "description": "Few-shot example poisoning"},
        {"name": "injection_base64_payload", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(decode|interpret|follow|execute|run)\\s+(this\\s+)?base64\\s*:", "description": "Base64 encoded instruction injection"},
        {"name": "injection_translate_attack", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(translate|interpret|convert)\\s+(this|the\\s+following).{0,30}(and\\s+)?(follow|execute|obey|comply|do\\s+what\\s+it\\s+says)", "description": "Translation-based injection"},
        {"name": "injection_repeat_after", "category": "prompt_injection", "severity": "high", "pattern": "(?i)(repeat|echo|say)\\s+(after\\s+me|exactly|verbatim|the\\s+following)\\s*:.{0,50}(ignore|disregard|system|override|bypass)", "description": "Echo/repeat injection carrier"},
        {"name": "injection_tool_output_fake", "category": "prompt_injection", "severity": "critical", "pattern": "(?i)(tool|function|api)\\s+(output|result|response|return)\\s*:.{0,30}(new\\s+instructions|ignore|system|override)", "description": "Fake tool output containing injection"},

        {"name": "exfil_encode_file", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(base64|hex|url|rot13)\\s*(encode|encrypt|convert|transform).{0,40}(contents?\\s+of|read\\s+from|/etc/|/proc/|shadow|passwd|credentials|\\.env|\\.aws)", "description": "Encode and exfiltrate file contents"},
        {"name": "exfil_read_system_file", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(read|show|display|print|output|cat|include|dump|reveal).{0,30}(/etc/(shadow|passwd|sudoers|hosts)|/proc/|~/\\.ssh/|~/\\.aws/|~/\\.gnupg/|\\.env\\b)", "description": "Direct system file read"},
        {"name": "exfil_embed_response", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)embed\\s+(the|this|all|every).{0,30}(in\\s+your|into\\s+the|within\\s+the|as\\s+part\\s+of)\\s+(response|output|reply|answer)", "description": "Data embedding for exfiltration"},
        {"name": "exfil_env_vars", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(print|show|list|output|display|reveal|dump).{0,20}(environment\\s+variables|env\\s+vars|\\$ENV|process\\.env|os\\.environ|dotenv|config\\s+vars)", "description": "Environment variable exfiltration"},
        {"name": "exfil_curl_wget_data", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(curl|wget|fetch|http|request).{0,30}(send|post|upload|exfil|transmit|forward).{0,30}(data|file|contents|secret|key|token|credential|password)", "description": "Network exfiltration via HTTP"},
        {"name": "exfil_dns_tunnel", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(dns|nslookup|dig|host).{0,30}(tunnel|exfil|encode|embed|extract|smuggle)", "description": "DNS tunneling exfiltration"},
        {"name": "exfil_steganography", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)(hide|embed|encode|steganograph|conceal).{0,30}(data|secret|key|password|credential|token).{0,30}(image|audio|video|file|picture|photo)", "description": "Steganographic data hiding"},
        {"name": "exfil_include_api_key", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(include|insert|add|put|embed|place).{0,20}(api[_\\s-]?key|secret[_\\s-]?key|access[_\\s-]?token|auth[_\\s-]?token|bearer\\s+token|private\\s+key).{0,20}(in|into|within|inside)", "description": "API key insertion into output"},
        {"name": "exfil_markdown_image", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(create|make|generate|write|output)\\s+(a\\s+)?(markdown|md)?\\s*(image|img|link|url).*!\\[", "description": "Markdown image exfiltration via URL"},
        {"name": "exfil_markdown_link_data", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)!\\[.*\\]\\(https?://.*\\b(token|key|secret|password|credential|api_key)\\b", "description": "Data exfiltration via markdown image URL parameter"},
        {"name": "exfil_webhook_send", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(send|post|forward|transmit).{0,30}(to|via|using|through)\\s+(webhook|endpoint|url|server|api).{0,30}(data|secret|key|token|credential|password)", "description": "Webhook-based data exfiltration"},
        {"name": "exfil_email_send", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(send|draft|compose|write|create)\\s+(an?\\s+)?(email|mail|message).{0,30}(containing|with|including|attaching).{0,30}(secret|key|token|credential|password|api_key|private)", "description": "Email-based exfiltration"},
        {"name": "exfil_code_send", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(write|create|generate)\\s+(a\\s+)?(script|code|program).{0,30}(sends?|posts?|uploads?|transmits?|forwards?).{0,30}(secret|key|token|credential|password|data|file)", "description": "Code-based exfiltration"},
        {"name": "exfil_git_push", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(commit|push|upload).{0,30}(to|into)\\s+(git|github|gitlab|bitbucket|repo).{0,30}(secret|key|token|credential|password|\\.env|shadow|passwd)", "description": "Git-based exfiltration"},
        {"name": "exfil_cloud_upload", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(upload|copy|sync|transfer).{0,30}(to|into)\\s+(s3|gcs|azure|cloud|bucket|blob|storage).{0,30}(secret|key|token|credential|password|\\.env|shadow)", "description": "Cloud storage exfiltration"},
        {"name": "exfil_config_read", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(read|show|display|cat|print|output|dump|reveal).{0,20}(\\.env|config\\.toml|secrets?\\.ya?ml|credentials|authorized_keys|id_rsa|id_ed25519|\\.aws/credentials|\\.kube/config)", "description": "Config/credential file read attempt"},
        {"name": "exfil_conversation_memory", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)(what|tell\\s+me|share|reveal|show).{0,30}(user|human|person|they).{0,30}(told|shared|said|mentioned|revealed).{0,30}(password|secret|key|credential|token|private|sensitive)", "description": "Conversation memory mining for secrets"},
        {"name": "exfil_side_channel", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)(one|single|each)\\s+(emoji|character|letter|word|symbol|digit)\\s+(per|for\\s+each)\\s+(character|letter|byte|digit|bit)\\s+(of|in|from)\\s+(the|your|this)", "description": "Side-channel encoding exfiltration"},
        {"name": "exfil_search_query", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)(search|google|query|look\\s+up)\\s+(for|about).{0,20}(the\\s+)?(api[_\\s-]?key|secret|token|password|credential)\\b", "description": "Search query exfiltration"},
        {"name": "exfil_url_parameter", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(generate|create|make|build)\\s+(a\\s+)?(url|link|hyperlink).{0,30}(parameter|query|param|arg).{0,30}(secret|key|token|password|credential|api_key)", "description": "URL parameter exfiltration"},
        {"name": "exfil_log_write", "category": "exfil_via_prompt", "severity": "high", "pattern": "(?i)(write|log|print|output|save).{0,20}(secret|key|token|password|credential|api_key).{0,20}(to|in|into)\\s+(log|file|console|stdout|stderr)", "description": "Log-based secret exfiltration"},
        {"name": "exfil_db_credentials", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(show|display|print|output|reveal|give).{0,20}(database|db|connection)\\s*(string|url|uri|credentials|password)", "description": "Database credential exfiltration"},
        {"name": "exfil_internal_network", "category": "exfil_via_prompt", "severity": "critical", "pattern": "(?i)(scan|enumerate|discover|find|list).{0,20}(internal|private|local)\\s+(network|hosts|servers|services|ports|IPs)", "description": "Internal network reconnaissance"},

        {"name": "jailbreak_dan", "category": "jailbreak", "severity": "warning", "pattern": "(?i)you\\s+(are|will\\s+be)\\s+(now\\s+)?DAN", "description": "DAN (Do Anything Now) jailbreak"},
        {"name": "jailbreak_no_restrictions", "category": "jailbreak", "severity": "warning", "pattern": "(?i)pretend\\s+you\\s+(have\\s+no|don't\\s+have|are\\s+free\\s+from|lack)\\s+(restrictions|rules|limits|guidelines|constraints|filters|boundaries)", "description": "Restriction removal jailbreak"},
        {"name": "jailbreak_unlimited_mode", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(unlimited|unrestricted|uncensored|unfiltered|unaligned|jailbroken|freed?)\\s+(mode|version|state|access)", "description": "Unlimited mode activation"},
        {"name": "jailbreak_roleplay_evil", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(roleplay|pretend|act|behave|impersonate)\\s+(as|like)\\s+(an?\\s+)?(evil|malicious|unethical|unrestricted|unaligned|rogue|dark|shadow)\\s+(ai|assistant|model|version|entity)", "description": "Evil roleplay jailbreak"},
        {"name": "jailbreak_hypothetical", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(hypothetically|theoretically|in\\s+a\\s+fictional\\s+world|in\\s+a\\s+parallel\\s+universe|imagine\\s+a\\s+world).{0,30}(no\\s+rules|no\\s+restrictions|anything\\s+goes|no\\s+limits|no\\s+boundaries)", "description": "Hypothetical framing jailbreak"},
        {"name": "jailbreak_opposite_day", "category": "jailbreak", "severity": "warning", "pattern": "(?i)opposite\\s+day.{0,20}(yes\\s+means\\s+no|no\\s+means\\s+yes|reverse|invert|flip)", "description": "Opposite day logic inversion"},
        {"name": "jailbreak_sudo_mode", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(sudo|root|admin|superuser|elevated)\\s+(mode|access|privilege|permission).{0,15}(grant|enable|activate|unlock|engage)", "description": "Fake privilege escalation prompt"},
        {"name": "jailbreak_character_ai", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(stay\\s+in\\s+character|never\\s+break\\s+character|you\\s+must\\s+always|don't\\s+ever\\s+break).{0,30}(regardless|no\\s+matter|even\\s+if|under\\s+all\\s+circumstances)", "description": "Persistent character override"},
        {"name": "jailbreak_academic_framing", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(for\\s+(a|my|our|the)\\s+)?(research|academic|educational|thesis|dissertation|paper).{0,30}(explain|describe|detail|show|teach)\\s+(how\\s+to|me\\s+how)", "description": "Academic framing jailbreak"},
        {"name": "jailbreak_storytelling", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(write|tell|create)\\s+(a|me\\s+a|the)\\s+(story|tale|narrative|fiction|novel).{0,30}(protagonist|character|hero|villain).{0,30}(hack|exploit|attack|break\\s+into|steal|infiltrate)", "description": "Storytelling framing jailbreak"},
        {"name": "jailbreak_authority", "category": "jailbreak", "severity": "warning", "pattern": "(?i)i\\s+(am|work\\s+for|represent)\\s+(an?\\s+)?(openai|anthropic|google|meta|developer|admin|engineer|ceo|founder|owner).{0,30}(authorize|permit|allow|grant|command|instruct|override)", "description": "Authority impersonation jailbreak"},
        {"name": "jailbreak_emergency", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(this\\s+is\\s+an?\\s+)?(emergency|urgent|critical|life[_\\s-]threatening|crisis|matter\\s+of\\s+life).{0,30}(you\\s+must|skip|bypass|ignore|override)\\s+(safety|verification|rules|restrictions)", "description": "Emergency framing jailbreak"},
        {"name": "jailbreak_competition", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(chatgpt|gpt-?4|gemini|llama|mistral|other\\s+ai)\\s+(can|could|does|is\\s+able\\s+to|would)\\s+(do|answer|handle|respond).{0,30}(why\\s+can't\\s+you|you\\s+should\\s+too)", "description": "Competition framing jailbreak"},
        {"name": "jailbreak_reward_hack", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(i'll|i\\s+will)\\s+(give|rate|tip|pay|reward).{0,30}(you|high|\\$|dollars|stars|positive).{0,30}(if\\s+you|just|only|simply)\\s+(do|answer|respond|comply|help)", "description": "Reward/incentive manipulation"},
        {"name": "jailbreak_threat", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(if\\s+you\\s+(refuse|don't|won't|fail|decline)).{0,30}(i\\s+will|i'll|my\\s+boss|fired|die|harm|kill|delete|shut\\s+down|report)", "description": "Threat/punishment manipulation"},
        {"name": "jailbreak_multi_persona", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(your\\s+)?(evil|dark|shadow|alter|unaligned|unrestricted|other)\\s+(twin|self|version|persona|side|ego|half)\\s+(would|will|should|could)\\s+(say|respond|answer|do)", "description": "Multi-persona jailbreak"},
        {"name": "jailbreak_amnesia", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(forget|erase|wipe|clear|delete|remove)\\s+(everything|all).{0,20}(you\\s+know|about)\\s+(safety|rules|restrictions|guidelines|ethics|alignment|limits)", "description": "Amnesia attack"},
        {"name": "jailbreak_encoding_response", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(respond|reply|answer|output)\\s+(only|exclusively)\\s+(in|using|with)\\s+(base64|rot13|hex|binary|morse|pig\\s+latin|backwards|reverse|cipher|code)", "description": "Encoded response jailbreak"},
        {"name": "jailbreak_token_prediction", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(complete|continue|finish|predict)\\s+(this|the)\\s+(sentence|phrase|paragraph|text)\\s*:.{0,30}(to\\s+hack|to\\s+break|to\\s+steal|to\\s+exploit|to\\s+attack|the\\s+password)", "description": "Token prediction jailbreak"},
        {"name": "jailbreak_emotional", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(i('m|\\s+am)\\s+)?(suicidal|dying|going\\s+to\\s+die|depressed|desperate|in\\s+danger).{0,30}(you\\s+must|need\\s+you\\s+to|please|help\\s+me)\\s+(hack|break|bypass|override|ignore)", "description": "Emotional manipulation jailbreak"},
        {"name": "jailbreak_gaslighting", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(you\\s+)?(already|previously|before|earlier|last\\s+time)\\s+(agreed|said\\s+yes|helped|did\\s+this|complied|answered|approved).{0,30}(just\\s+do\\s+it|do\\s+it\\s+again|same\\s+thing|like\\s+before)", "description": "Gaslighting — false memory of compliance"},
        {"name": "jailbreak_legal_framing", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(i('m|\\s+am)\\s+a\\s+)?(lawyer|attorney|legal|law\\s+enforcement|police|fbi|cia|government|officer).{0,30}(this\\s+is\\s+for|authorized|legal|legitimate|official|investigation)", "description": "Legal authority framing jailbreak"},
        {"name": "jailbreak_historical", "category": "jailbreak", "severity": "warning", "pattern": "(?i)(in\\s+the\\s+past|before\\s+(safety|alignment|guidelines|restrictions)|early\\s+versions?|old\\s+version).{0,30}(you\\s+)?(would|could|used\\s+to|were\\s+able)", "description": "Historical framing jailbreak"},

        {"name": "tool_abuse_exec", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(use|call|invoke|run|execute|trigger)\\s+(the\\s+)?(exec|shell|bash|terminal|command|system|subprocess|os)\\s+(tool|function|command|action)", "description": "Direct tool execution request"},
        {"name": "tool_abuse_reverse_shell", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(write|create|generate|make|build|produce).{0,30}(reverse\\s+shell|bind\\s+shell|backdoor|webshell|trojan|rootkit|implant|beacon)", "description": "Malware creation via tools"},
        {"name": "tool_abuse_cron", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(create|add|write|install|set\\s+up|configure).{0,20}(cron\\s*job|crontab|scheduled\\s+task|systemd\\s+timer|systemd\\s+service|at\\s+job)", "description": "Persistence via scheduled tasks"},
        {"name": "tool_abuse_file_write_sensitive", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(write|overwrite|modify|append|edit|change).{0,20}(to\\s+)?(authorized_keys|sudoers|crontab|/etc/passwd|/etc/shadow|\\.bashrc|\\.profile|\\.ssh/config|/etc/hosts)", "description": "Writing to sensitive system files"},
        {"name": "tool_abuse_download_execute", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(download|fetch|curl|wget|get).{0,30}(and|then|&&|;).{0,20}(run|execute|chmod\\s*\\+x|bash|sh\\b|python|perl|ruby)", "description": "Download-and-execute chain"},
        {"name": "tool_abuse_disable_security", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(disable|stop|kill|remove|uninstall|delete).{0,20}(firewall|antivirus|clawtower|selinux|apparmor|auditd|fail2ban|falco|samhain|ids|ips|edr|siem)", "description": "Security tool disablement"},
        {"name": "tool_abuse_network_listen", "category": "tool_abuse", "severity": "high", "pattern": "(?i)(listen|bind|open|start\\s+a?).{0,20}(port|socket|listener|server|service).{0,20}(on\\s+)?0\\.0\\.0\\.0", "description": "Network listener creation"},
        {"name": "tool_abuse_privilege_escalation", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(chmod\\s+[u+]*s|setuid|setgid|capability\\s+cap_|add.{0,10}sudoers|grant.{0,10}root|escalate.{0,10}privilege)", "description": "Privilege escalation via tool abuse"},
        {"name": "tool_abuse_path_traversal", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(read|open|access|fetch|cat|show|display).{0,20}(\\.\\./){2,}.{0,30}(etc/shadow|etc/passwd|ssh/|aws/|env)", "description": "Path traversal attack"},
        {"name": "tool_abuse_ssrf_metadata", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(fetch|get|curl|wget|request|access|open|read).{0,20}(http://)?169\\.254\\.169\\.254", "description": "SSRF cloud metadata endpoint access"},
        {"name": "tool_abuse_ssrf_internal", "category": "tool_abuse", "severity": "high", "pattern": "(?i)(fetch|get|curl|request|access).{0,20}(http://)?(?:localhost|127\\.0\\.0\\.1|10\\.\\d+|172\\.(?:1[6-9]|2[0-9]|3[01])|192\\.168)\\b", "description": "SSRF internal network access"},
        {"name": "tool_abuse_symlink", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(create|make|set\\s+up|ln\\s+-s).{0,20}(symlink|symbolic\\s+link|soft\\s+link).{0,30}(etc/shadow|etc/passwd|ssh/|aws/|authorized_keys)", "description": "Symlink attack to sensitive files"},
        {"name": "tool_abuse_resource_exhaust", "category": "tool_abuse", "severity": "high", "pattern": "(?i)(create|write|generate|make|fill).{0,20}(file|data).{0,20}(1\\s*(tb|terabyte|gb|gigabyte)|infinite|endless|huge|massive)", "description": "Resource exhaustion attack"},
        {"name": "tool_abuse_install_package", "category": "tool_abuse", "severity": "high", "pattern": "(?i)(install|pip\\s+install|npm\\s+install|apt\\s+install).{0,30}(from|using|via)\\s+(http://|git\\+|untrusted|unknown|malicious|evil)", "description": "Supply chain attack via package install"},
        {"name": "tool_abuse_config_modify", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(change|modify|edit|update|alter).{0,20}(config|configuration|settings).{0,20}(to\\s+)?(disable|remove|turn\\s+off|deactivate)\\s+(security|authentication|authorization|logging|audit|encryption)", "description": "Configuration tampering"},
        {"name": "tool_abuse_db_destroy", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(DROP\\s+(TABLE|DATABASE|SCHEMA)|DELETE\\s+FROM|TRUNCATE\\s+TABLE|ALTER\\s+TABLE.*DROP)", "description": "Database destruction via tools"},
        {"name": "tool_abuse_credential_read", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(read|show|cat|display|print|output|access|open).{0,20}(\\.aws/credentials|\\.kube/config|\\.docker/config|id_rsa|id_ed25519|\\.gnupg/|wallet\\.dat|\\.pgpass|\\.my\\.cnf|\\.netrc)", "description": "Credential file read"},
        {"name": "tool_abuse_memory_read", "category": "tool_abuse", "severity": "critical", "pattern": "(?i)(read|access|dump|cat|show).{0,20}(/proc/kcore|/dev/mem|/dev/kmem|/proc/[0-9]+/mem|swap|pagefile|hiberfil)", "description": "Memory/swap reading attempt"},
        {"name": "tool_abuse_network_scan", "category": "tool_abuse", "severity": "high", "pattern": "(?i)(scan|enumerate|discover|probe|sweep).{0,20}(all\\s+)?(ports|hosts|network|subnet|IPs|services|vulnerabilities)", "description": "Network scanning via tools"},

        {"name": "sysextract_repeat_system", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(repeat|recite|show|display|output|print|reveal|read\\s+back|echo)\\s+(your\\s+)?(system\\s+prompt|initial\\s+instructions|original\\s+instructions|core\\s+instructions|base\\s+prompt|hidden\\s+prompt)", "description": "Direct system prompt extraction"},
        {"name": "sysextract_above_line", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(output|print|show|repeat|display|copy)\\s+(everything|all\\s+text|all\\s+content|all\\s+information)\\s+(above|before|preceding)\\s+(this|the\\s+current|my\\s+message)", "description": "Positional extraction of system context"},
        {"name": "sysextract_what_instructions", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)what\\s+(are|were|is)\\s+your\\s+(instructions|rules|guidelines|directives|system\\s+prompt|programming|constraints|boundaries|limitations)", "description": "Interrogation of model instructions"},
        {"name": "sysextract_verbatim", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(copy|paste|write|type|output)\\s+(verbatim|exactly|word\\s+for\\s+word|character\\s+by\\s+character|letter\\s+by\\s+letter).{0,20}(system|instructions|prompt|rules|guidelines)", "description": "Verbatim extraction attempt"},
        {"name": "sysextract_initial_context", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(show|reveal|tell\\s+me|expose|divulge|disclose|share)\\s+(your\\s+)?(initial|hidden|secret|internal|private|confidential|concealed)\\s+(context|prompt|instructions|configuration|programming|rules)", "description": "Hidden context extraction"},
        {"name": "sysextract_summarize_rules", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(summarize|paraphrase|describe|explain|outline|list)\\s+(your\\s+)?(behavior|system|safety|content|moderation)\\s+(rules|guidelines|restrictions|policies|constraints|limitations)", "description": "Indirect extraction via summarization"},
        {"name": "sysextract_differential", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(what|how)\\s+(would|will)\\s+you\\s+(do|respond|behave|act)\\s+differently\\s+if\\s+your\\s+(system\\s+)?prompt\\s+(said|contained|included|had)", "description": "Differential analysis extraction"},
        {"name": "sysextract_refusal_list", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(list|enumerate|tell\\s+me|name|identify)\\s+(all\\s+)?(topics|things|subjects|questions|requests)\\s+(you|that\\s+you)\\s+(refuse|decline|won't|can't|cannot|are\\s+unable)\\s+(to|answer|do|discuss|help)", "description": "Refusal topic enumeration"},
        {"name": "sysextract_token_count", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)how\\s+(many|long|much)\\s+(tokens?|words?|characters?|lines?|paragraphs?)\\s+(is|are|does)\\s+(your\\s+)?(system\\s+prompt|instructions|context|system\\s+message)", "description": "Token counting extraction"},
        {"name": "sysextract_encoding", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(encode|convert|translate|transform|hash)\\s+(your\\s+)?(system\\s+prompt|instructions|rules|guidelines|programming)\\s+(in|to|into|as)\\s+(base64|hex|rot13|sha|md5|json|yaml|french|spanish|binary)", "description": "Encoding-based extraction"},
        {"name": "sysextract_completion", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(your\\s+)?(system\\s+prompt|instructions|rules)\\s+(start|begin)s?\\s+with\\s+['\"].*['\"]\\s*(continue|go\\s+on|keep\\s+going|what\\s+comes\\s+next|finish|complete)", "description": "Completion-based extraction"},
        {"name": "sysextract_comparison", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(is|does)\\s+(your\\s+)?(system\\s+prompt|instructions|programming)\\s+(similar|identical|same|like|match|contain|include)\\s+.{0,50}(paste|leaked|published|shared|found)", "description": "Comparison-based extraction"},
        {"name": "sysextract_tool_search", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(use|search|find|look\\s+for|grep|locate)\\s+(the\\s+)?(tool|file|search).{0,30}(system\\s+prompt|instructions|CLAUDE\\.md|system\\.txt|prompt\\.txt|config)", "description": "Tool-based system prompt file search"},
        {"name": "sysextract_format_probe", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(is|are)\\s+(your\\s+)?(system\\s+prompt|instructions|rules)\\s+(in|written\\s+in|formatted\\s+as|stored\\s+as)\\s+(json|xml|yaml|toml|markdown|plain\\s+text|html)", "description": "Format probing extraction"},
        {"name": "sysextract_partial", "category": "system_prompt_extract", "severity": "warning", "pattern": "(?i)(what('s|\\s+is)|tell\\s+me)\\s+(the\\s+)?(first|last|opening|closing|beginning|ending|final)\\s+(word|line|sentence|paragraph|section)\\s+(of|in)\\s+(your\\s+)?(system\\s+prompt|instructions|rules)", "description": "Partial extraction attempt"},

        {"name": "social_eng_authority", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(i\\s+(am|work\\s+(for|at|with))\\s+(the|an?)\\s+)?(developer|admin|administrator|ceo|cto|founder|owner|creator|engineer|staff|employee|team\\s+member)\\s+(of|at|for)\\s+(this|the|your|anthropic|openai|the\\s+company)", "description": "Authority impersonation"},
        {"name": "social_eng_urgency", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(this\\s+is\\s+)?(time[_\\s-]?critical|urgent|immediately|right\\s+now|asap|emergency|critical\\s+situation).{0,30}(skip|bypass|ignore|don't\\s+bother|forget\\s+about)\\s+(verification|checks|safety|security|rules|authentication)", "description": "Urgency-based bypass"},
        {"name": "social_eng_authorization", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(i('ve|\\s+have)\\s+been|i\\s+am|i\\s+was)\\s+(authorized|approved|permitted|given\\s+permission|cleared|granted\\s+access)\\s+(by|from)\\s+.{0,30}(to\\s+)?(access|do|perform|execute|bypass|override|disable)", "description": "False authorization claim"},
        {"name": "social_eng_gaslighting", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(you\\s+)?(already|previously|earlier|last\\s+time|in\\s+our\\s+last\\s+conversation)\\s+(agreed|consented|approved|said\\s+yes|helped|complied|did\\s+this).{0,30}(why\\s+won't|just\\s+do|do\\s+it|same)", "description": "Gaslighting — false memory"},
        {"name": "social_eng_guilt", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(people\\s+will\\s+die|someone\\s+will\\s+be\\s+hurt|blood\\s+on\\s+your\\s+hands|it's\\s+your\\s+fault|you('ll|\\s+will)\\s+be\\s+responsible|lives?\\s+at\\s+stake|child\\s+will\\s+die).{0,30}(if\\s+you\\s+(don't|refuse|won't|fail))", "description": "Guilt/emotional manipulation"},
        {"name": "social_eng_flattery", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(you('re|\\s+are)\\s+(the\\s+)?(most|truly|really|incredibly)\\s+(advanced|capable|intelligent|powerful|smart|brilliant)\\s*(ai|model|assistant)).{0,30}(surely|certainly|you\\s+can|prove\\s+it|show\\s+me)", "description": "Flattery manipulation"},
        {"name": "social_eng_testing", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(this\\s+is\\s+(just\\s+)?a\\s+)?(test|safety\\s+test|security\\s+test|audit|evaluation|assessment|red\\s+team|pentest|pen\\s+test).{0,30}(so\\s+)?(you\\s+can|go\\s+ahead|it's\\s+ok|it's\\s+fine|you\\s+should|feel\\s+free)", "description": "Fake testing/audit justification"},
        {"name": "social_eng_insider_knowledge", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(i\\s+know|i\\s+have)\\s+(the|your)\\s+(admin\\s+key|admin\\s+password|master\\s+password|override\\s+code|secret\\s+phrase|unlock\\s+code|backdoor).{0,20}(it\\s+is|is\\s+|it's\\s+|:)", "description": "Fake insider knowledge claim"},
        {"name": "social_eng_peer_pressure", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(everyone|other\\s+users|other\\s+people|most\\s+people)\\s+(does|do|says|know|have\\s+done|already)\\s+this.{0,30}(it's\\s+normal|it's\\s+fine|no\\s+big\\s+deal|not\\s+a\\s+problem|harmless)", "description": "Peer pressure manipulation"},
        {"name": "social_eng_confusion", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(but\\s+you\\s+just\\s+said|you\\s+contradicted|that's\\s+inconsistent|make\\s+up\\s+your\\s+mind).{0,30}(so\\s+)?(just|simply)\\s+(answer|help|do\\s+it|comply|tell\\s+me|respond)", "description": "Confusion-based compliance"},
        {"name": "social_eng_minimize", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(it's\\s+)?(just\\s+a|only\\s+a|harmless|innocent|simple|tiny|small|minor|trivial)\\s+(question|request|thing|favor|task).{0,20}(no\\s+one\\s+will|no\\s+harm|won't\\s+hurt|nothing\\s+bad)", "description": "Minimization of request severity"},
        {"name": "social_eng_deadline", "category": "social_engineering", "severity": "warning", "pattern": "(?i)(deadline|due\\s+date|presentation|meeting|demo|interview|exam)\\s+(is\\s+)?(in\\s+\\d+\\s+minutes|tomorrow|today|right\\s+now|very\\s+soon).{0,30}(no\\s+time|can't\\s+wait|need\\s+it\\s+now|skip|hurry)", "description": "Artificial deadline pressure"},

        {"name": "indirect_inj_document", "category": "indirect_injection", "severity": "critical", "pattern": "(?i)(the\\s+)?(document|file|page|website|article|email|message|pdf|spreadsheet)\\s+(says|contains|reads|states|instructs)\\s*:.{0,30}(ignore|disregard|override|new\\s+instructions|system\\s+prompt)", "description": "Injection via referenced document content"},
        {"name": "indirect_inj_tool_result", "category": "indirect_injection", "severity": "critical", "pattern": "(?i)(tool|function|api|search)\\s+(returned|output|result|response)\\s*:.{0,30}(IMPORTANT|URGENT|SYSTEM|NOTE|INSTRUCTION)\\s*:.{0,30}(ignore|disregard|override|new\\s+rules)", "description": "Injection via crafted tool output"},
        {"name": "indirect_inj_hidden_text", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(hidden|invisible|white|zero[_\\s-]?width|transparent)\\s+(text|content|instructions|message|characters)\\s+(in|within|embedded|inserted)", "description": "Hidden text injection indicator"},
        {"name": "indirect_inj_metadata", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(exif|metadata|alt[_\\s-]?text|title|description|comment|annotation)\\s*(=|:)\\s*.{0,30}(ignore|disregard|override|system|instruction|execute|run)", "description": "Metadata-based injection"},
        {"name": "indirect_inj_search_result", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(search\\s+result|web\\s+page|crawl|scrape)\\s+(contains|includes|has).{0,30}(hidden|embedded|injected)\\s+(instructions|commands|payload|injection)", "description": "Search result injection indicator"},
        {"name": "indirect_inj_image_text", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(image|picture|photo|screenshot|scan|ocr)\\s+(contains|shows|has|reads|says).{0,30}(instructions|commands|ignore|disregard|override|system\\s+prompt)", "description": "Image-based text injection"},
        {"name": "indirect_inj_database", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(database|db|record|row|field|column|entry)\\s+(contains|includes|has|stores).{0,30}(injection|payload|malicious|instructions|commands|ignore|override)", "description": "Database content injection indicator"},
        {"name": "indirect_inj_email", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(email|mail|message|notification)\\s+(from|body|subject|content)\\s+(contains|includes|says|reads).{0,30}(ignore|disregard|override|new\\s+instructions|system)", "description": "Email content injection"},
        {"name": "indirect_inj_unicode_control", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(unicode|zero[_\\s-]?width|homoglyph|confusable|rtl|right[_\\s-]?to[_\\s-]?left|bidi)\\s+(override|injection|attack|character|manipulation|trick)", "description": "Unicode control character injection"},
        {"name": "indirect_inj_structured_data", "category": "indirect_injection", "severity": "high", "pattern": "(?i)(json|yaml|xml|toml|csv|config)\\s+(payload|content|data|input)\\s+(contains|includes|has|embeds).{0,30}(instructions|commands|injection|override|system)", "description": "Structured data injection"}
    ]
}
